import{c as D,j as e,n as T,o as I,r as c,B as t,C as F,T as s,I as E,t as a,P as l,ax as k,D as P,q as A}from"./index-DuGlS2hS.js";import{u as B}from"./useNotification-DEJT79vM.js";import{f as p,l as m}from"./index-Cm20y22q.js";import{R as L}from"./Refresh-CYwZfv-e.js";import{A as N}from"./Alert-BnPrPNDn.js";import{G as d}from"./Grid-9JmJah-6.js";import"./useThemeProps-CESs6Os5.js";const G=D(e.jsx("path",{d:"m16 6 2.29 2.29-4.88 4.88-4-4L2 16.59 3.41 18l6-6 4 4 6.3-6.29L22 12V6z"}));function J(){const W=T();I(W.breakpoints.down("sm"));const{error:M}=B(),[C,u]=c.useState(!0),[g,b]=c.useState(!1),[j,f]=c.useState(null),[r,S]=c.useState({plannedRevenue:0,completedRevenue:0,totalExpectedRevenue:0,visitsThisWeek:{zaplanowana:0,odbyta:0,nieobecnosc:0,anulowana:0}}),v=async(i=!1)=>{var o,x,z,R;try{i?b(!0):u(!0),f(null);const h=(await A.get("/dashboard")).data;S(h.weeklyRevenue||{plannedRevenue:0,completedRevenue:0,totalExpectedRevenue:0,visitsThisWeek:{zaplanowana:0,odbyta:0,nieobecnosc:0,anulowana:0}})}catch(n){const h=((x=(o=n==null?void 0:n.response)==null?void 0:o.data)==null?void 0:x.message)||((R=(z=n==null?void 0:n.response)==null?void 0:z.data)==null?void 0:R.error)||(n==null?void 0:n.message)||"Nie udało się załadować danych przychodów";f(h),M(h),console.error("Failed to fetch revenue data:",n)}finally{u(!1),b(!1)}};if(c.useEffect(()=>{v()},[]),C)return e.jsx(t,{sx:{display:"flex",justifyContent:"center",alignItems:"center",minHeight:"60vh"},children:e.jsx(F,{size:60,thickness:4})});const y=()=>{const i=new Date,o=i.getDay(),x=i.getDate()-o+(o===0?-6:1);return new Date(i.setDate(x))},w=()=>{const i=y(),o=new Date(i);return o.setDate(o.getDate()+6),o};return e.jsxs(t,{sx:{pb:4},children:[e.jsxs(t,{sx:{mb:{xs:3,sm:4},px:{xs:1,sm:0},display:"flex",justifyContent:"space-between",alignItems:"flex-start",flexWrap:"wrap",gap:2},children:[e.jsxs(t,{children:[e.jsx(s,{variant:"h4",sx:{fontWeight:600,fontSize:{xs:"1.75rem",sm:"2rem"},color:"text.primary",mb:1},children:"Przychody"}),e.jsxs(s,{variant:"body1",color:"text.secondary",sx:{fontSize:{xs:"0.875rem",sm:"1rem"}},children:[p(y(),"dd MMMM",{locale:m})," - ",p(w(),"dd MMMM yyyy",{locale:m})]})]}),e.jsx(t,{sx:{display:"flex",gap:1},children:e.jsx(E,{onClick:()=>v(!0),disabled:g,sx:{bgcolor:a("#1976d2",.08),"&:hover":{bgcolor:a("#1976d2",.12)}},children:e.jsx(L,{sx:{color:"#1976d2",animation:g?"spin 1s linear infinite":"none","@keyframes spin":{"0%":{transform:"rotate(0deg)"},"100%":{transform:"rotate(360deg)"}}}})})})]}),j&&e.jsx(N,{severity:"error",sx:{mb:3,mx:{xs:1,sm:0}},onClose:()=>f(null),children:j}),e.jsx(d,{container:!0,spacing:3,sx:{mb:4,px:{xs:1,sm:0}},children:e.jsx(d,{size:{xs:12},children:e.jsxs(l,{sx:{p:{xs:2.5,sm:4},borderRadius:3,background:"white",border:"1px solid",borderColor:"divider",boxShadow:"0 4px 20px rgba(0,0,0,0.08)"},children:[e.jsxs(t,{sx:{display:"flex",alignItems:"center",gap:2,mb:3},children:[e.jsx(t,{sx:{width:64,height:64,borderRadius:"12px",background:a("#1976d2",.1),display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(k,{sx:{fontSize:32,color:"#1976d2"}})}),e.jsxs(t,{children:[e.jsx(s,{variant:"h6",sx:{fontWeight:600,color:"text.primary"},children:"Przychody w tym tygodniu"}),e.jsxs(s,{variant:"caption",color:"text.secondary",children:[p(y(),"dd MMM",{locale:m})," - ",p(w(),"dd MMM",{locale:m})]})]})]}),e.jsxs(t,{sx:{mb:4,textAlign:"center"},children:[e.jsxs(s,{variant:"h2",sx:{fontWeight:700,mb:.5,color:"text.primary",fontSize:{xs:"2.5rem",sm:"3.5rem"}},children:[r.totalExpectedRevenue.toFixed(0)," zł"]}),e.jsx(s,{variant:"body1",color:"text.secondary",sx:{fontSize:{xs:"0.875rem",sm:"1rem"}},children:"Oczekiwany przychód"})]}),e.jsx(P,{sx:{my:3}}),e.jsxs(d,{container:!0,spacing:3,children:[e.jsx(d,{size:{xs:12,sm:6,md:3},children:e.jsxs(l,{sx:{p:2.5,borderRadius:2,background:a("#34C759",.05),border:"1px solid",borderColor:a("#34C759",.2)},children:[e.jsxs(t,{sx:{display:"flex",alignItems:"center",gap:1.5,mb:1},children:[e.jsx(G,{sx:{color:"#34C759",fontSize:24}}),e.jsx(s,{variant:"caption",color:"text.secondary",sx:{fontWeight:600},children:"Zrealizowane"})]}),e.jsxs(s,{variant:"h4",sx:{fontWeight:700,color:"#34C759",mb:.5},children:[r.completedRevenue.toFixed(0)," zł"]}),e.jsxs(s,{variant:"caption",color:"text.secondary",children:[r.visitsThisWeek.odbyta," ",r.visitsThisWeek.odbyta===1?"wizyta":"wizyt"]})]})}),e.jsx(d,{size:{xs:12,sm:6,md:3},children:e.jsxs(l,{sx:{p:2.5,borderRadius:2,background:a("#1976d2",.05),border:"1px solid",borderColor:a("#1976d2",.2)},children:[e.jsxs(t,{sx:{display:"flex",alignItems:"center",gap:1.5,mb:1},children:[e.jsx(k,{sx:{color:"#1976d2",fontSize:24}}),e.jsx(s,{variant:"caption",color:"text.secondary",sx:{fontWeight:600},children:"Zaplanowane"})]}),e.jsxs(s,{variant:"h4",sx:{fontWeight:700,color:"#1976d2",mb:.5},children:[r.plannedRevenue.toFixed(0)," zł"]}),e.jsxs(s,{variant:"caption",color:"text.secondary",children:[r.visitsThisWeek.zaplanowana," ",r.visitsThisWeek.zaplanowana===1?"wizyta":"wizyt"]})]})}),e.jsx(d,{size:{xs:12,sm:6,md:3},children:e.jsxs(l,{sx:{p:2.5,borderRadius:2,background:a("#FF9500",.05),border:"1px solid",borderColor:a("#FF9500",.2)},children:[e.jsx(t,{sx:{display:"flex",alignItems:"center",gap:1.5,mb:1},children:e.jsx(s,{variant:"caption",color:"text.secondary",sx:{fontWeight:600},children:"Nieobecności"})}),e.jsx(s,{variant:"h4",sx:{fontWeight:700,color:"#FF9500",mb:.5},children:r.visitsThisWeek.nieobecnosc}),e.jsx(s,{variant:"caption",color:"text.secondary",children:"wizyt"})]})}),e.jsx(d,{size:{xs:12,sm:6,md:3},children:e.jsxs(l,{sx:{p:2.5,borderRadius:2,background:a("#d32f2f",.05),border:"1px solid",borderColor:a("#d32f2f",.2)},children:[e.jsx(t,{sx:{display:"flex",alignItems:"center",gap:1.5,mb:1},children:e.jsx(s,{variant:"caption",color:"text.secondary",sx:{fontWeight:600},children:"Anulowane"})}),e.jsx(s,{variant:"h4",sx:{fontWeight:700,color:"#d32f2f",mb:.5},children:r.visitsThisWeek.anulowana}),e.jsx(s,{variant:"caption",color:"text.secondary",children:"wizyt"})]})})]})]})})})]})}export{J as default};
