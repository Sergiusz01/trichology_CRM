import{r as b,S as Yt,H as Ye,ah as eo,g as _t,a as Kt,b as Jt,j as a,s as q,e as tt,f as ot,h as Qt,m as Oe,J as ht,P as vt,I as $t,N as to,p as oo,O as no,q as et,B as mt,t as Rt,T as ao,C as Dt}from"./index-DuGlS2hS.js";import{u as ro}from"./useNotification-DEJT79vM.js";import{P as Xt,V as so}from"./visitStatus-kedmqlXd.js";import{i as Nt,g as bt,d as io,H as lo,e as Mt,h as Wt,M as uo}from"./dateFormat-D5f9IIy8.js";import{C as po}from"./Container-DggLIBHC.js";import{A as co}from"./ArrowBack-BLijn9hB.js";import{C as fo,A as Ft}from"./Alert-BnPrPNDn.js";import{G as U}from"./Grid-9JmJah-6.js";import{a as xt,A as go,c as ke,i as Se,o as Et,d as It,S as yt}from"./Select-DgRGz9X7.js";import{C as ho}from"./Chip-CKQ1KLG2.js";import{T as Ce,F as Pt,I as St}from"./TextField-VtT5fMIl.js";import{M as Ct}from"./MenuItem-0hJOb36H.js";import{I as mo}from"./InputAdornment-BplF7Ie4.js";import{B as Vt}from"./Button-DYA-l7Ix.js";import{S as bo}from"./Save-6ATMd_0t.js";import"./useThemeProps-CESs6Os5.js";function xo(o){const r=b.useRef({});return b.useEffect(()=>{r.current=o}),r.current}function Ht({array1:o,array2:r,parser:f=g=>g}){return o&&r&&o.length===r.length&&o.every((g,S)=>f(g)===f(r[S]))}function Bt(o){return o.normalize("NFD").replace(/[\u0300-\u036f]/g,"")}function Io(o={}){const{ignoreAccents:r=!0,ignoreCase:f=!0,limit:g,matchFrom:S="any",stringify:D,trim:C=!1}=o;return(O,{inputValue:H,getOptionLabel:F})=>{let v=C?H.trim():H;f&&(v=v.toLowerCase()),r&&(v=Bt(v));const $=v?O.filter(ue=>{let N=(D||F)(ue);return f&&(N=N.toLowerCase()),r&&(N=Bt(N)),S==="start"?N.startsWith(v):N.includes(v)}):O;return typeof g=="number"?$.slice(0,g):$}}const yo=Io(),Gt=5,Po=o=>{var r;return o.current!==null&&((r=o.current.parentElement)==null?void 0:r.contains(document.activeElement))},So=[];function Ut(o,r,f,g){if(r||o==null||g)return"";const S=f(o);return typeof S=="string"?S:""}function Co(o){const{unstable_isActiveElementInListbox:r=Po,unstable_classNamePrefix:f="Mui",autoComplete:g=!1,autoHighlight:S=!1,autoSelect:D=!1,blurOnSelect:C=!1,clearOnBlur:O=!o.freeSolo,clearOnEscape:H=!1,componentName:F="useAutocomplete",defaultValue:v=o.multiple?So:null,disableClearable:$=!1,disableCloseOnSelect:ue=!1,disabled:N,disabledItemsFocusable:me=!1,disableListWrap:ve=!1,filterOptions:X=yo,filterSelectedOptions:Y=!1,freeSolo:w=!1,getOptionDisabled:p,getOptionKey:pe,getOptionLabel:we=t=>t.label??t,groupBy:ee,handleHomeEndKeys:E=!o.freeSolo,id:Ve,includeInputInList:be=!1,inputValue:s,isOptionEqualToValue:y=(t,e)=>t===e,multiple:c=!1,onChange:te,onClose:oe,onHighlightChange:T,onInputChange:x,onOpen:He,open:At,openOnFocus:jt=!1,options:zt,readOnly:ne=!1,renderValue:W,selectOnFocus:nt=!o.freeSolo,value:Be}=o,B=Yt(Ve);let j=we;j=t=>{const e=we(t);return typeof e!="string"?String(e):e};const Te=b.useRef(!1),Re=b.useRef(!0),z=b.useRef(null),G=b.useRef(null),[De,Lt]=b.useState(null),[V,xe]=b.useState(-1),at=S?0:-1,R=b.useRef(at),kt=b.useRef(Ut(v??Be,c,j)).current,[i,rt]=xt({controlled:Be,default:v,name:F}),[m,ae]=xt({controlled:s,default:kt,name:F,state:"inputValue"}),[$e,Ge]=b.useState(!1),Ae=b.useCallback((t,e,n)=>{if(!(c?i.length<e.length:e!==null)&&!O)return;const u=Ut(e,c,j,W);m!==u&&(ae(u),x&&x(t,u,n))},[j,m,c,x,ae,O,i,W]),[re,Ie]=xt({controlled:At,default:!1,name:F,state:"open"}),[wt,je]=b.useState(!0),Ue=!c&&i!=null&&m===j(i),M=re&&!ne,I=M?X(zt.filter(t=>!(Y&&(c?i:[i]).some(e=>e!==null&&y(t,e)))),{inputValue:Ue&&wt?"":m,getOptionLabel:j}):[],Z=xo({filteredOptions:I,value:i,inputValue:m});b.useEffect(()=>{const t=i!==Z.value;$e&&!t||w&&!t||Ae(null,i,"reset")},[i,Ae,$e,Z.value,w]);const qe=re&&I.length>0&&!ne,Q=Ye(t=>{if(t===-1)z.current.focus();else{const e=W?"data-item-index":"data-tag-index";De.querySelector(`[${e}="${t}"]`).focus()}});b.useEffect(()=>{c&&V>i.length-1&&(xe(-1),Q(-1))},[i,c,V,Q]);function st(t,e){if(!G.current||t<0||t>=I.length)return-1;let n=t;for(;;){const l=G.current.querySelector(`[data-option-index="${n}"]`),u=me?!1:!l||l.disabled||l.getAttribute("aria-disabled")==="true";if(l&&l.hasAttribute("tabindex")&&!u)return n;if(e==="next"?n=(n+1)%I.length:n=(n-1+I.length)%I.length,n===t)return-1}}const se=Ye(({event:t,index:e,reason:n})=>{if(R.current=e,e===-1?z.current.removeAttribute("aria-activedescendant"):z.current.setAttribute("aria-activedescendant",`${B}-option-${e}`),T&&["mouse","keyboard","touch"].includes(n)&&T(t,e===-1?null:I[e],n),!G.current)return;const l=G.current.querySelector(`[role="option"].${f}-focused`);l&&(l.classList.remove(`${f}-focused`),l.classList.remove(`${f}-focusVisible`));let u=G.current;if(G.current.getAttribute("role")!=="listbox"&&(u=G.current.parentElement.querySelector('[role="listbox"]')),!u)return;if(e===-1){u.scrollTop=0;return}const k=G.current.querySelector(`[data-option-index="${e}"]`);if(k&&(k.classList.add(`${f}-focused`),n==="keyboard"&&k.classList.add(`${f}-focusVisible`),u.scrollHeight>u.clientHeight&&n!=="mouse"&&n!=="touch")){const P=k,J=u.clientHeight+u.scrollTop,Je=P.offsetTop+P.offsetHeight;Je>J?u.scrollTop=Je-u.clientHeight:P.offsetTop-P.offsetHeight*(ee?1.3:0)<u.scrollTop&&(u.scrollTop=P.offsetTop-P.offsetHeight*(ee?1.3:0))}}),_=Ye(({event:t,diff:e,direction:n="next",reason:l})=>{if(!M)return;const k=st((()=>{const P=I.length-1;if(e==="reset")return at;if(e==="start")return 0;if(e==="end")return P;const J=R.current+e;return J<0?J===-1&&be?-1:ve&&R.current!==-1||Math.abs(e)>1?0:P:J>P?J===P+1&&be?-1:ve||Math.abs(e)>1?P:0:J})(),n);if(se({index:k,reason:l,event:t}),g&&e!=="reset")if(k===-1)z.current.value=m;else{const P=j(I[k]);z.current.value=P,P.toLowerCase().indexOf(m.toLowerCase())===0&&m.length>0&&z.current.setSelectionRange(m.length,P.length)}}),Ze=!Ht({array1:Z.filteredOptions,array2:I,parser:j}),it=()=>{const t=(e,n)=>{const l=e?j(e):"",u=n?j(n):"";return l===u};if(R.current!==-1&&!Ht({array1:Z.filteredOptions,array2:I,parser:j})&&Z.inputValue===m&&(c?i.length===Z.value.length&&Z.value.every((e,n)=>j(i[n])===j(e)):t(Z.value,i))){const e=Z.filteredOptions[R.current];if(e)return I.findIndex(n=>j(n)===j(e))}return-1},Ne=b.useCallback(()=>{if(!M)return;const t=it();if(t!==-1){R.current=t;return}const e=c?i[0]:i;if(I.length===0||e==null){_({diff:"reset"});return}if(G.current){if(e!=null){const n=I[R.current];if(c&&n&&i.findIndex(u=>y(n,u))!==-1)return;const l=I.findIndex(u=>y(u,e));l===-1?_({diff:"reset"}):se({index:l});return}if(R.current>=I.length-1){se({index:I.length-1});return}se({index:R.current})}},[I.length,c?!1:i,_,se,M,m,c]),ce=Ye(t=>{eo(G,t),t&&Ne()});b.useEffect(()=>{(Ze||M)&&Ne()},[Ne,Ze,M]);const ie=t=>{re||(Ie(!0),je(!0),He&&He(t))},ye=(t,e)=>{re&&(Ie(!1),oe&&oe(t,e))},K=(t,e,n,l)=>{if(c){if(i.length===e.length&&i.every((u,k)=>u===e[k]))return}else if(i===e)return;te&&te(t,e,n,l),rt(e)},le=b.useRef(!1),de=(t,e,n="selectOption",l="options")=>{let u=n,k=e;if(c){k=Array.isArray(i)?i.slice():[];const P=k.findIndex(J=>y(e,J));P===-1?k.push(e):l!=="freeSolo"&&(k.splice(P,1),u="removeOption")}Ae(t,k,u),K(t,k,u,{option:e}),!ue&&(!t||!t.ctrlKey&&!t.metaKey)&&ye(t,u),(C===!0||C==="touch"&&le.current||C==="mouse"&&!le.current)&&z.current.blur()};function lt(t,e){if(t===-1)return-1;let n=t;for(;;){if(e==="next"&&n===i.length||e==="previous"&&n===-1)return-1;const l=W?"data-item-index":"data-tag-index",u=De.querySelector(`[${l}="${n}"]`);if(!u||!u.hasAttribute("tabindex")||u.disabled||u.getAttribute("aria-disabled")==="true")n+=e==="next"?1:-1;else return n}}const Pe=(t,e)=>{if(!c)return;m===""&&ye(t,"toggleInput");let n=V;V===-1&&e==="previous"?(n=i.length-1,w&&m!==""&&(ae(""),x&&x(t,"","reset"))):(n+=e==="next"?1:-1,n<0&&(n=0),n===i.length&&(n=-1)),n=lt(n,e),xe(n),Q(n)},_e=t=>{Te.current=!0,ae(""),x&&x(t,"","clear"),K(t,c?[]:null,"clear")},ut=t=>e=>{if(t.onKeyDown&&t.onKeyDown(e),!e.defaultMuiPrevented&&(V!==-1&&!["ArrowLeft","ArrowRight"].includes(e.key)&&(xe(-1),Q(-1)),e.which!==229))switch(e.key){case"Home":M&&E&&(e.preventDefault(),_({diff:"start",direction:"next",reason:"keyboard",event:e}));break;case"End":M&&E&&(e.preventDefault(),_({diff:"end",direction:"previous",reason:"keyboard",event:e}));break;case"PageUp":e.preventDefault(),_({diff:-Gt,direction:"previous",reason:"keyboard",event:e}),ie(e);break;case"PageDown":e.preventDefault(),_({diff:Gt,direction:"next",reason:"keyboard",event:e}),ie(e);break;case"ArrowDown":e.preventDefault(),_({diff:1,direction:"next",reason:"keyboard",event:e}),ie(e);break;case"ArrowUp":e.preventDefault(),_({diff:-1,direction:"previous",reason:"keyboard",event:e}),ie(e);break;case"ArrowLeft":{const n=z.current;if(!(n&&n.selectionStart===0&&n.selectionEnd===0))return;!c&&W&&i!=null?(w&&m!==""&&(ae(""),x&&x(e,"","reset")),xe(0),Q(0)):Pe(e,"previous");break}case"ArrowRight":!c&&W?(xe(-1),Q(-1)):Pe(e,"next");break;case"Enter":if(R.current!==-1&&M){const n=I[R.current],l=p?p(n):!1;if(e.preventDefault(),l)return;de(e,n,"selectOption"),g&&z.current.setSelectionRange(z.current.value.length,z.current.value.length)}else w&&m!==""&&Ue===!1&&(c&&e.preventDefault(),de(e,m,"createOption","freeSolo"));break;case"Escape":M?(e.preventDefault(),e.stopPropagation(),ye(e,"escape")):H&&(m!==""||c&&i.length>0||W)&&(e.preventDefault(),e.stopPropagation(),_e(e));break;case"Backspace":if(c&&!ne&&m===""&&i.length>0){const n=V===-1?i.length-1:V,l=i.slice();l.splice(n,1),K(e,l,"removeOption",{option:i[n]})}!c&&W&&!ne&&m===""&&K(e,null,"removeOption",{option:i});break;case"Delete":if(c&&!ne&&m===""&&i.length>0&&V!==-1){const n=V,l=i.slice();l.splice(n,1),K(e,l,"removeOption",{option:i[n]})}!c&&W&&!ne&&m===""&&K(e,null,"removeOption",{option:i});break}},ze=t=>{Ge(!0),V!==-1&&(xe(-1),Q(-1)),jt&&!Te.current&&ie(t)},Le=t=>{if(r(G)){z.current.focus();return}Ge(!1),Re.current=!0,Te.current=!1,D&&R.current!==-1&&M?de(t,I[R.current],"blur"):D&&w&&m!==""?de(t,m,"blur","freeSolo"):O&&Ae(t,i,"blur"),ye(t,"blur")},Me=t=>{const e=t.target.value;m!==e&&(ae(e),je(!1),x&&x(t,e,"input")),e===""?!$&&!c&&!W&&K(t,null,"clear"):ie(t)},pt=t=>{const e=Number(t.currentTarget.getAttribute("data-option-index"));R.current!==e&&se({event:t,index:e,reason:"mouse"})},ct=t=>{se({event:t,index:Number(t.currentTarget.getAttribute("data-option-index")),reason:"touch"}),le.current=!0},dt=t=>{const e=Number(t.currentTarget.getAttribute("data-option-index"));de(t,I[e],"selectOption"),le.current=!1},ft=t=>e=>{const n=i.slice();n.splice(t,1),K(e,n,"removeOption",{option:i[t]})},We=t=>{K(t,null,"removeOption",{option:i})},A=t=>{re?ye(t,"toggleInput"):ie(t)},L=t=>{t.currentTarget.contains(t.target)&&t.target.getAttribute("id")!==B&&t.preventDefault()},fe=t=>{t.currentTarget.contains(t.target)&&(z.current.focus(),nt&&Re.current&&z.current.selectionEnd-z.current.selectionStart===0&&z.current.select(),Re.current=!1)},gt=t=>{!N&&(m===""||!re)&&A(t)};let Fe=w&&m.length>0;Fe=Fe||(c?i.length>0:i!==null);let Ke=I;return ee&&(Ke=I.reduce((t,e,n)=>{const l=ee(e);return t.length>0&&t[t.length-1].group===l?t[t.length-1].options.push(e):t.push({key:n,index:n,group:l,options:[e]}),t},[])),N&&$e&&Le(),{getRootProps:(t={})=>({...t,onKeyDown:ut(t),onMouseDown:L,onClick:fe}),getInputLabelProps:()=>({id:`${B}-label`,htmlFor:B}),getInputProps:()=>({id:B,value:m,onBlur:Le,onFocus:ze,onChange:Me,onMouseDown:gt,"aria-activedescendant":M?"":null,"aria-autocomplete":g?"both":"list","aria-controls":qe?`${B}-listbox`:void 0,"aria-expanded":qe,autoComplete:"off",ref:z,autoCapitalize:"none",spellCheck:"false",role:"combobox",disabled:N}),getClearProps:()=>({tabIndex:-1,type:"button",onClick:_e}),getItemProps:({index:t=0}={})=>({...c&&{key:t},...W?{"data-item-index":t}:{"data-tag-index":t},tabIndex:-1,...!ne&&{onDelete:c?ft(t):We}}),getPopupIndicatorProps:()=>({tabIndex:-1,type:"button",onClick:A}),getTagProps:({index:t})=>({key:t,"data-tag-index":t,tabIndex:-1,...!ne&&{onDelete:ft(t)}}),getListboxProps:()=>({role:"listbox",id:`${B}-listbox`,"aria-labelledby":`${B}-label`,ref:ce,onMouseDown:t=>{t.preventDefault()}}),getOptionProps:({index:t,option:e})=>{const n=(c?i:[i]).some(u=>u!=null&&y(e,u)),l=p?p(e):!1;return{key:(pe==null?void 0:pe(e))??j(e),tabIndex:-1,role:"option",id:`${B}-option-${t}`,onMouseMove:pt,onClick:dt,onTouchStart:ct,"data-option-index":t,"aria-disabled":l,"aria-selected":n}},id:B,inputValue:m,value:i,dirty:Fe,expanded:M&&De,popupOpen:M,focused:$e||V!==-1,anchorEl:De,setAnchorEl:Lt,focusedItem:V,focusedTag:V,groupedOptions:Ke}}function Oo(o){return _t("MuiListSubheader",o)}Kt("MuiListSubheader",["root","colorPrimary","colorInherit","gutters","inset","sticky"]);const vo=o=>{const{classes:r,color:f,disableGutters:g,inset:S,disableSticky:D}=o,C={root:["root",f!=="default"&&`color${ot(f)}`,!g&&"gutters",S&&"inset",!D&&"sticky"]};return Qt(C,Oo,r)},$o=q("li",{name:"MuiListSubheader",slot:"Root",overridesResolver:(o,r)=>{const{ownerState:f}=o;return[r.root,f.color!=="default"&&r[`color${ot(f.color)}`],!f.disableGutters&&r.gutters,f.inset&&r.inset,!f.disableSticky&&r.sticky]}})(Oe(({theme:o})=>({boxSizing:"border-box",lineHeight:"48px",listStyle:"none",color:(o.vars||o).palette.text.secondary,fontFamily:o.typography.fontFamily,fontWeight:o.typography.fontWeightMedium,fontSize:o.typography.pxToRem(14),variants:[{props:{color:"primary"},style:{color:(o.vars||o).palette.primary.main}},{props:{color:"inherit"},style:{color:"inherit"}},{props:({ownerState:r})=>!r.disableGutters,style:{paddingLeft:16,paddingRight:16}},{props:({ownerState:r})=>r.inset,style:{paddingLeft:72}},{props:({ownerState:r})=>!r.disableSticky,style:{position:"sticky",top:0,zIndex:1,backgroundColor:(o.vars||o).palette.background.paper}}]}))),Ot=b.forwardRef(function(r,f){const g=Jt({props:r,name:"MuiListSubheader"}),{className:S,color:D="default",component:C="li",disableGutters:O=!1,disableSticky:H=!1,inset:F=!1,...v}=g,$={...g,color:D,component:C,disableGutters:O,disableSticky:H,inset:F},ue=vo($);return a.jsx($o,{as:C,className:tt(ue.root,S),ref:f,ownerState:$,...v})});Ot&&(Ot.muiSkipListHighlight=!0);function Ao(o){return _t("MuiAutocomplete",o)}const d=Kt("MuiAutocomplete",["root","expanded","fullWidth","focused","focusVisible","tag","tagSizeSmall","tagSizeMedium","hasPopupIcon","hasClearIcon","inputRoot","input","inputFocused","endAdornment","clearIndicator","popupIndicator","popupIndicatorOpen","popper","popperDisablePortal","paper","listbox","loading","noOptions","option","groupLabel","groupUl"]);var qt,Zt;const jo=o=>{const{classes:r,disablePortal:f,expanded:g,focused:S,fullWidth:D,hasClearIcon:C,hasPopupIcon:O,inputFocused:H,popupOpen:F,size:v}=o,$={root:["root",g&&"expanded",S&&"focused",D&&"fullWidth",C&&"hasClearIcon",O&&"hasPopupIcon"],inputRoot:["inputRoot"],input:["input",H&&"inputFocused"],tag:["tag",`tagSize${ot(v)}`],endAdornment:["endAdornment"],clearIndicator:["clearIndicator"],popupIndicator:["popupIndicator",F&&"popupIndicatorOpen"],popper:["popper",f&&"popperDisablePortal"],paper:["paper"],listbox:["listbox"],loading:["loading"],noOptions:["noOptions"],option:["option"],groupLabel:["groupLabel"],groupUl:["groupUl"]};return Qt($,Ao,r)},zo=q("div",{name:"MuiAutocomplete",slot:"Root",overridesResolver:(o,r)=>{const{ownerState:f}=o,{fullWidth:g,hasClearIcon:S,hasPopupIcon:D,inputFocused:C,size:O}=f;return[{[`& .${d.tag}`]:r.tag},{[`& .${d.tag}`]:r[`tagSize${ot(O)}`]},{[`& .${d.inputRoot}`]:r.inputRoot},{[`& .${d.input}`]:r.input},{[`& .${d.input}`]:C&&r.inputFocused},r.root,g&&r.fullWidth,D&&r.hasPopupIcon,S&&r.hasClearIcon]}})({[`&.${d.focused} .${d.clearIndicator}`]:{visibility:"visible"},"@media (pointer: fine)":{[`&:hover .${d.clearIndicator}`]:{visibility:"visible"}},[`& .${d.tag}`]:{margin:3,maxWidth:"calc(100% - 6px)"},[`& .${d.inputRoot}`]:{[`.${d.hasPopupIcon}&, .${d.hasClearIcon}&`]:{paddingRight:30},[`.${d.hasPopupIcon}.${d.hasClearIcon}&`]:{paddingRight:56},[`& .${d.input}`]:{width:0,minWidth:30}},[`& .${It.root}`]:{paddingBottom:1,"& .MuiInput-input":{padding:"4px 4px 4px 0px"}},[`& .${It.root}.${Se.sizeSmall}`]:{[`& .${It.input}`]:{padding:"2px 4px 3px 0"}},[`& .${Et.root}`]:{padding:9,[`.${d.hasPopupIcon}&, .${d.hasClearIcon}&`]:{paddingRight:39},[`.${d.hasPopupIcon}.${d.hasClearIcon}&`]:{paddingRight:65},[`& .${d.input}`]:{padding:"7.5px 4px 7.5px 5px"},[`& .${d.endAdornment}`]:{right:9}},[`& .${Et.root}.${Se.sizeSmall}`]:{paddingTop:6,paddingBottom:6,paddingLeft:6,[`& .${d.input}`]:{padding:"2.5px 4px 2.5px 8px"}},[`& .${ke.root}`]:{paddingTop:19,paddingLeft:8,[`.${d.hasPopupIcon}&, .${d.hasClearIcon}&`]:{paddingRight:39},[`.${d.hasPopupIcon}.${d.hasClearIcon}&`]:{paddingRight:65},[`& .${ke.input}`]:{padding:"7px 4px"},[`& .${d.endAdornment}`]:{right:9}},[`& .${ke.root}.${Se.sizeSmall}`]:{paddingBottom:1,[`& .${ke.input}`]:{padding:"2.5px 4px"}},[`& .${Se.hiddenLabel}`]:{paddingTop:8},[`& .${ke.root}.${Se.hiddenLabel}`]:{paddingTop:0,paddingBottom:0,[`& .${d.input}`]:{paddingTop:16,paddingBottom:17}},[`& .${ke.root}.${Se.hiddenLabel}.${Se.sizeSmall}`]:{[`& .${d.input}`]:{paddingTop:8,paddingBottom:9}},[`& .${d.input}`]:{flexGrow:1,textOverflow:"ellipsis",opacity:0},variants:[{props:{fullWidth:!0},style:{width:"100%"}},{props:{size:"small"},style:{[`& .${d.tag}`]:{margin:2,maxWidth:"calc(100% - 4px)"}}},{props:{inputFocused:!0},style:{[`& .${d.input}`]:{opacity:1}}},{props:{multiple:!0},style:{[`& .${d.inputRoot}`]:{flexWrap:"wrap"}}}]}),Lo=q("div",{name:"MuiAutocomplete",slot:"EndAdornment"})({position:"absolute",right:0,top:"50%",transform:"translate(0, -50%)"}),ko=q($t,{name:"MuiAutocomplete",slot:"ClearIndicator"})({marginRight:-2,padding:4,visibility:"hidden"}),wo=q($t,{name:"MuiAutocomplete",slot:"PopupIndicator",overridesResolver:(o,r)=>{const{ownerState:f}=o;return[r.popupIndicator,f.popupOpen&&r.popupIndicatorOpen]}})({padding:2,marginRight:-2,variants:[{props:{popupOpen:!0},style:{transform:"rotate(180deg)"}}]}),To=q(Xt,{name:"MuiAutocomplete",slot:"Popper",overridesResolver:(o,r)=>{const{ownerState:f}=o;return[{[`& .${d.option}`]:r.option},r.popper,f.disablePortal&&r.popperDisablePortal]}})(Oe(({theme:o})=>({zIndex:(o.vars||o).zIndex.modal,variants:[{props:{disablePortal:!0},style:{position:"absolute"}}]}))),Ro=q(vt,{name:"MuiAutocomplete",slot:"Paper"})(Oe(({theme:o})=>({...o.typography.body1,overflow:"auto"}))),Do=q("div",{name:"MuiAutocomplete",slot:"Loading"})(Oe(({theme:o})=>({color:(o.vars||o).palette.text.secondary,padding:"14px 16px"}))),No=q("div",{name:"MuiAutocomplete",slot:"NoOptions"})(Oe(({theme:o})=>({color:(o.vars||o).palette.text.secondary,padding:"14px 16px"}))),Mo=q("ul",{name:"MuiAutocomplete",slot:"Listbox"})(Oe(({theme:o})=>({listStyle:"none",margin:0,padding:"8px 0",maxHeight:"40vh",overflow:"auto",position:"relative",[`& .${d.option}`]:{minHeight:48,display:"flex",overflow:"hidden",justifyContent:"flex-start",alignItems:"center",cursor:"pointer",paddingTop:6,boxSizing:"border-box",outline:"0",WebkitTapHighlightColor:"transparent",paddingBottom:6,paddingLeft:16,paddingRight:16,[o.breakpoints.up("sm")]:{minHeight:"auto"},[`&.${d.focused}`]:{backgroundColor:(o.vars||o).palette.action.hover,"@media (hover: none)":{backgroundColor:"transparent"}},'&[aria-disabled="true"]':{opacity:(o.vars||o).palette.action.disabledOpacity,pointerEvents:"none"},[`&.${d.focusVisible}`]:{backgroundColor:(o.vars||o).palette.action.focus},'&[aria-selected="true"]':{backgroundColor:o.alpha((o.vars||o).palette.primary.main,(o.vars||o).palette.action.selectedOpacity),[`&.${d.focused}`]:{backgroundColor:o.alpha((o.vars||o).palette.primary.main,`${(o.vars||o).palette.action.selectedOpacity} + ${(o.vars||o).palette.action.hoverOpacity}`),"@media (hover: none)":{backgroundColor:(o.vars||o).palette.action.selected}},[`&.${d.focusVisible}`]:{backgroundColor:o.alpha((o.vars||o).palette.primary.main,`${(o.vars||o).palette.action.selectedOpacity} + ${(o.vars||o).palette.action.focusOpacity}`)}}}}))),Wo=q(Ot,{name:"MuiAutocomplete",slot:"GroupLabel"})(Oe(({theme:o})=>({backgroundColor:(o.vars||o).palette.background.paper,top:-8}))),Fo=q("ul",{name:"MuiAutocomplete",slot:"GroupUl"})({padding:0,[`& .${d.option}`]:{paddingLeft:24}}),Eo=b.forwardRef(function(r,f){const g=Jt({props:r,name:"MuiAutocomplete"}),{autoComplete:S=!1,autoHighlight:D=!1,autoSelect:C=!1,blurOnSelect:O=!1,ChipProps:H,className:F,clearIcon:v=qt||(qt=a.jsx(fo,{fontSize:"small"})),clearOnBlur:$=!g.freeSolo,clearOnEscape:ue=!1,clearText:N="Clear",closeText:me="Close",componentsProps:ve,defaultValue:X=g.multiple?[]:null,disableClearable:Y=!1,disableCloseOnSelect:w=!1,disabled:p=!1,disabledItemsFocusable:pe=!1,disableListWrap:we=!1,disablePortal:ee=!1,filterOptions:E,filterSelectedOptions:Ve=!1,forcePopupIcon:be="auto",freeSolo:s=!1,fullWidth:y=!1,getLimitTagsText:c=h=>`+${h}`,getOptionDisabled:te,getOptionKey:oe,getOptionLabel:T,isOptionEqualToValue:x,groupBy:He,handleHomeEndKeys:At=!g.freeSolo,id:jt,includeInputInList:zt=!1,inputValue:ne,limitTags:W=-1,ListboxComponent:nt,ListboxProps:Be,loading:B=!1,loadingText:j="Loading…",multiple:Te=!1,noOptionsText:Re="No options",onChange:z,onClose:G,onHighlightChange:De,onInputChange:Lt,onOpen:V,open:xe,openOnFocus:at=!1,openText:R="Open",options:kt,PaperComponent:i,PopperComponent:rt,popupIcon:m=Zt||(Zt=a.jsx(go,{})),readOnly:ae=!1,renderGroup:$e,renderInput:Ge,renderOption:Ae,renderTags:re,renderValue:Ie,selectOnFocus:wt=!g.freeSolo,size:je="medium",slots:Ue={},slotProps:M={},value:I,...Z}=g,{getRootProps:qe,getInputProps:Q,getInputLabelProps:st,getPopupIndicatorProps:se,getClearProps:_,getItemProps:Ze,getListboxProps:it,getOptionProps:Ne,value:ce,dirty:ie,expanded:ye,id:K,popupOpen:le,focused:de,focusedItem:lt,anchorEl:Pe,setAnchorEl:_e,inputValue:ut,groupedOptions:ze}=Co({...g,componentName:"Autocomplete"}),Le=!Y&&!p&&ie&&!ae,Me=(!s||be===!0)&&be!==!1,{onMouseDown:pt}=Q(),{ref:ct,...dt}=it(),We=T||(h=>h.label??h),A={...g,disablePortal:ee,expanded:ye,focused:de,fullWidth:y,getOptionLabel:We,hasClearIcon:Le,hasPopupIcon:Me,inputFocused:lt===-1,popupOpen:le,size:je},L=jo(A),fe={slots:{paper:i,popper:rt,...Ue},slotProps:{chip:H,listbox:Be,...ve,...M}},[gt,Fe]=ht("listbox",{elementType:Mo,externalForwardedProps:fe,ownerState:A,className:L.listbox,additionalProps:dt,ref:ct}),[Ke,t]=ht("paper",{elementType:vt,externalForwardedProps:fe,ownerState:A,className:L.paper}),[e,n]=ht("popper",{elementType:Xt,externalForwardedProps:fe,ownerState:A,className:L.popper,additionalProps:{disablePortal:ee,style:{width:Pe?Pe.clientWidth:null},role:"presentation",anchorEl:Pe,open:le}});let l;const u=h=>({className:L.tag,disabled:p,...Ze(h)});if(Te?ce.length>0&&(re?l=re(ce,u,A):Ie?l=Ie(ce,u,A):l=ce.map((h,ge)=>{const{key:he,...Ee}=u({index:ge});return a.jsx(ho,{label:We(h),size:je,...Ee,...fe.slotProps.chip},he)})):Ie&&ce!=null&&(l=Ie(ce,u,A)),W>-1&&Array.isArray(l)){const h=l.length-W;!de&&h>0&&(l=l.splice(0,W),l.push(a.jsx("span",{className:L.tag,children:c(h)},l.length)))}const P=$e||(h=>a.jsxs("li",{children:[a.jsx(Wo,{className:L.groupLabel,ownerState:A,component:"div",children:h.group}),a.jsx(Fo,{className:L.groupUl,ownerState:A,children:h.children})]},h.key)),Je=Ae||((h,ge)=>{const{key:he,...Ee}=h;return a.jsx("li",{...Ee,children:We(ge)},he)}),Tt=(h,ge)=>{const he=Ne({option:h,index:ge});return Je({...he,className:L.option},h,{selected:he["aria-selected"],index:ge,inputValue:ut},A)},Qe=fe.slotProps.clearIndicator,Xe=fe.slotProps.popupIndicator;return a.jsxs(b.Fragment,{children:[a.jsx(zo,{ref:f,className:tt(L.root,F),ownerState:A,...qe(Z),children:Ge({id:K,disabled:p,fullWidth:!0,size:je==="small"?"small":void 0,InputLabelProps:st(),InputProps:{ref:_e,className:L.inputRoot,startAdornment:l,onMouseDown:h=>{h.target===h.currentTarget&&pt(h)},...(Le||Me)&&{endAdornment:a.jsxs(Lo,{className:L.endAdornment,ownerState:A,children:[Le?a.jsx(ko,{..._(),"aria-label":N,title:N,ownerState:A,...Qe,className:tt(L.clearIndicator,Qe==null?void 0:Qe.className),children:v}):null,Me?a.jsx(wo,{...se(),disabled:p,"aria-label":le?me:R,title:le?me:R,ownerState:A,...Xe,className:tt(L.popupIndicator,Xe==null?void 0:Xe.className),children:m}):null]})}},inputProps:{className:L.input,disabled:p,readOnly:ae,...Q()}})}),Pe?a.jsx(To,{as:e,...n,children:a.jsxs(Ro,{as:Ke,...t,children:[B&&ze.length===0?a.jsx(Do,{className:L.loading,ownerState:A,children:j}):null,ze.length===0&&!s&&!B?a.jsx(No,{className:L.noOptions,ownerState:A,role:"presentation",onMouseDown:h=>{h.preventDefault()},children:Re}):null,ze.length>0?a.jsx(gt,{as:nt,...Fe,children:ze.map((h,ge)=>He?P({key:h.key,group:h.group,children:h.options.map((he,Ee)=>Tt(he,h.index+Ee))}):Tt(h,ge))}):null]})}):null]})});function nn(){const{id:o,patientId:r}=to(),f=oo(),g=no(),{success:S,error:D}=ro(),[C,O]=b.useState(!1),[H,F]=b.useState(!1),[v,$]=b.useState(""),[ue,N]=b.useState(!1),[me,ve]=b.useState([]),X=g.pathname.includes("/visits/new")||!o&&r,Y=g.pathname.includes("/visits/new")?o:r||o,w=g.pathname.includes("/visits/new")?void 0:o,[p,pe]=b.useState({patientId:Y||"",data:Nt(new Date),rodzajZabiegu:"",notatki:"",status:"ZAPLANOWANA",numerWSerii:"",liczbaSerii:"",cena:""});b.useEffect(()=>{Y?pe(s=>({...s,patientId:Y})):we(),w&&!X&&ee()},[w,Y,X]);const we=async()=>{try{F(!0);const s=await et.get("/patients");ve(s.data.patients||[])}catch{D("Nie udało się załadować listy pacjentów")}finally{F(!1)}},ee=async()=>{var s,y,c,te,oe;if(!(!w||X))try{O(!0),$("");const x=(await et.get(`/visits/${w}`)).data.visit;if(!x){$("Wizyta nie znaleziona"),O(!1);return}pe({patientId:x.patientId,data:Nt(x.data),rodzajZabiegu:x.rodzajZabiegu||"",notatki:x.notatki||"",status:x.status||"ZAPLANOWANA",numerWSerii:((s=x.numerWSerii)==null?void 0:s.toString())||"",liczbaSerii:((y=x.liczbaSerii)==null?void 0:y.toString())||"",cena:((c=x.cena)==null?void 0:c.toString())||""})}catch(T){$(((oe=(te=T.response)==null?void 0:te.data)==null?void 0:oe.error)||"Nie udało się załadować wizyty")}finally{O(!1)}},E=(s,y)=>{pe(c=>({...c,[s]:y}))},Ve=async s=>{var y,c,te,oe;if(s.preventDefault(),$(""),N(!1),!p.patientId){$("Wybierz pacjenta");return}if(!p.rodzajZabiegu.trim()){$("Rodzaj zabiegu jest wymagany");return}try{O(!0);const T={patientId:p.patientId,data:p.data,rodzajZabiegu:p.rodzajZabiegu.trim(),status:p.status};p.notatki.trim()&&(T.notatki=p.notatki.trim()),p.numerWSerii&&(T.numerWSerii=parseInt(p.numerWSerii,10)),p.liczbaSerii&&(T.liczbaSerii=parseInt(p.liczbaSerii,10)),p.cena&&(T.cena=parseFloat(p.cena)),w&&!X?(await et.put(`/visits/${w}`,T),S("Wizyta została zaktualizowana")):(await et.post("/visits",T),S("Wizyta została dodana")),N(!0),setTimeout(()=>{f(`/patients/${p.patientId}`)},1500)}catch(T){const x=((c=(y=T.response)==null?void 0:y.data)==null?void 0:c.message)||((oe=(te=T.response)==null?void 0:te.data)==null?void 0:oe.error)||"Błąd podczas zapisywania wizyty";$(x),D(x)}finally{O(!1)}},be=me.find(s=>s.id===p.patientId);return a.jsx(mt,{sx:{width:"100%",maxWidth:"100%",overflow:"hidden"},children:a.jsxs(po,{maxWidth:"lg",sx:{py:4,px:{xs:2,sm:3}},children:[a.jsxs(mt,{sx:{mb:3,display:"flex",alignItems:"center",gap:2},children:[a.jsx($t,{onClick:()=>f(-1),sx:{bgcolor:Rt("#1976d2",.1),"&:hover":{bgcolor:Rt("#1976d2",.2)}},children:a.jsx(co,{sx:{color:"#1976d2"}})}),a.jsx(ao,{variant:"h4",sx:{fontWeight:600,color:"text.primary"},children:w&&!X?"Edytuj wizytę":"Nowa wizyta / zabieg"})]}),v&&a.jsx(Ft,{severity:"error",sx:{mb:3},onClose:()=>$(""),children:v}),ue&&a.jsx(Ft,{severity:"success",sx:{mb:3},children:w&&!X?"Wizyta została zaktualizowana":"Wizyta została dodana"}),a.jsx(vt,{sx:{p:{xs:2,sm:3},borderRadius:3,border:"1px solid",borderColor:"divider"},children:a.jsx("form",{onSubmit:Ve,children:a.jsxs(U,{container:!0,spacing:3,children:[!Y&&a.jsx(U,{size:{xs:12},children:a.jsx(Eo,{options:me,getOptionLabel:s=>`${s.firstName} ${s.lastName}`,value:be||null,onChange:(s,y)=>{E("patientId",(y==null?void 0:y.id)||"")},loading:H,renderInput:s=>a.jsx(Ce,{...s,label:"Pacjent *",required:!0,InputProps:{...s.InputProps,endAdornment:a.jsxs(a.Fragment,{children:[H?a.jsx(Dt,{size:20}):null,s.InputProps.endAdornment]})}})})}),a.jsx(U,{size:{xs:12,md:3},children:a.jsx(Ce,{fullWidth:!0,label:"Data *",type:"date",value:bt(p.data),onChange:s=>E("data",`${s.target.value}T${io(p.data)}`),required:!0,InputLabelProps:{shrink:!0}})}),a.jsx(U,{size:{xs:12,md:2},children:a.jsxs(Pt,{fullWidth:!0,required:!0,children:[a.jsx(St,{children:"Godz. *"}),a.jsx(yt,{value:Mt(p.data),onChange:s=>E("data",`${bt(p.data)}T${s.target.value.padStart(2,"0")}:${Wt(p.data)}`),label:"Godz. *",children:lo.map(s=>a.jsx(Ct,{value:s,children:s},s))})]})}),a.jsx(U,{size:{xs:12,md:2},children:a.jsxs(Pt,{fullWidth:!0,required:!0,children:[a.jsx(St,{children:"Min. *"}),a.jsx(yt,{value:Wt(p.data),onChange:s=>E("data",`${bt(p.data)}T${Mt(p.data).padStart(2,"0")}:${s.target.value}`),label:"Min. *",children:uo.map(s=>a.jsx(Ct,{value:s,children:s},s))})]})}),a.jsx(U,{size:{xs:12,md:6},children:a.jsx(Ce,{fullWidth:!0,label:"Rodzaj zabiegu *",value:p.rodzajZabiegu,onChange:s=>E("rodzajZabiegu",s.target.value),required:!0})}),a.jsx(U,{size:{xs:12,md:6},children:a.jsxs(Pt,{fullWidth:!0,children:[a.jsx(St,{children:"Status"}),a.jsx(yt,{value:p.status,onChange:s=>E("status",s.target.value),label:"Status",children:Object.entries(so).map(([s,y])=>a.jsx(Ct,{value:s,children:y.label},s))})]})}),a.jsx(U,{size:{xs:12,md:6},children:a.jsx(Ce,{fullWidth:!0,label:"Numer w serii",type:"number",value:p.numerWSerii,onChange:s=>E("numerWSerii",s.target.value),inputProps:{min:1}})}),a.jsx(U,{size:{xs:12,md:6},children:a.jsx(Ce,{fullWidth:!0,label:"Liczba serii",type:"number",value:p.liczbaSerii,onChange:s=>E("liczbaSerii",s.target.value),inputProps:{min:1}})}),a.jsx(U,{size:{xs:12,md:6},children:a.jsx(Ce,{fullWidth:!0,label:"Cena (zł)",type:"number",value:p.cena,onChange:s=>E("cena",s.target.value),inputProps:{min:0,step:.01},InputProps:{endAdornment:a.jsx(mo,{position:"end",children:"zł"})}})}),a.jsx(U,{size:{xs:12},children:a.jsx(Ce,{fullWidth:!0,label:"Notatki",multiline:!0,rows:4,value:p.notatki,onChange:s=>E("notatki",s.target.value)})}),a.jsx(U,{size:{xs:12},children:a.jsxs(mt,{sx:{display:"flex",gap:2,justifyContent:"flex-end"},children:[a.jsx(Vt,{variant:"outlined",onClick:()=>f(-1),disabled:C,children:"Anuluj"}),a.jsx(Vt,{type:"submit",variant:"contained",startIcon:C?a.jsx(Dt,{size:20}):a.jsx(bo,{}),disabled:C,sx:{bgcolor:"#1976d2","&:hover":{bgcolor:"#1565c0"}},children:C?"Zapisywanie...":"Zapisz"})]})})]})})})]})})}export{nn as default};
