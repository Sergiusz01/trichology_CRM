import{g as et,a as tt,r as x,b as rt,d as st,j as e,s as ae,e as at,f as W,h as ot,m as oe,i as K,k as ke,l as We,c as ne,n as nt,o as it,p as lt,q as J,B as i,C as fe,E as dt,T as a,I as ee,t as n,P,L as A,v as w,A as M,w as z,x as ge,R as U,D as be}from"./index-ik9JjyS6.js";import{u as ct}from"./useNotification-DgBW3D1z.js";import{V as L}from"./visitStatus-D0tn9_2F.js";import{P as Le,L as F,A as k}from"./PersonAdd-D_WekEfC.js";import{C as Fe}from"./CalendarToday-DUEIO3Zn.js";import{f as te,l as re}from"./index-B-6z-uVP.js";import{T as xt,N as se}from"./Notifications-BPynqar4.js";import{R as pt}from"./Refresh-F-fXWn1Z.js";import{B as G}from"./Button-B6n5coYQ.js";import{A as Ee}from"./Add-BfAxRG2-.js";import{A as Be}from"./Alert-Dzq7_ew3.js";import{T as ye}from"./TextField-BNTsiTHM.js";import{I as mt}from"./InputAdornment-D5dmfE1O.js";import{S as ht}from"./Search-DNQVKwVt.js";import{G as u}from"./Grid-OOY2WAvo.js";import{C as ut}from"./Card-CoKfBisl.js";import{C as ft}from"./CardContent-IdCV6dAg.js";import{C as je}from"./Chip-pTV9ioJu.js";import{E as gt}from"./EventAvailable-GyK5aXEc.js";import{D as bt,a as yt,b as jt,c as vt}from"./DialogTitle-DX1gnFsJ.js";import"./Select--zggdXop.js";import"./useThemeProps-C_QfMg4i.js";function Ct(o){return et("MuiLinearProgress",o)}tt("MuiLinearProgress",["root","colorPrimary","colorSecondary","determinate","indeterminate","buffer","query","dashed","dashedColorPrimary","dashedColorSecondary","bar","bar1","bar2","barColorPrimary","barColorSecondary","bar1Indeterminate","bar1Determinate","bar1Buffer","bar2Indeterminate","bar2Buffer"]);const ve=4,Ce=We`
  0% {
    left: -35%;
    right: 100%;
  }

  60% {
    left: 100%;
    right: -90%;
  }

  100% {
    left: 100%;
    right: -90%;
  }
`,wt=typeof Ce!="string"?ke`
        animation: ${Ce} 2.1s cubic-bezier(0.65, 0.815, 0.735, 0.395) infinite;
      `:null,we=We`
  0% {
    left: -200%;
    right: 100%;
  }

  60% {
    left: 107%;
    right: -8%;
  }

  100% {
    left: 107%;
    right: -8%;
  }
`,zt=typeof we!="string"?ke`
        animation: ${we} 2.1s cubic-bezier(0.165, 0.84, 0.44, 1) 1.15s infinite;
      `:null,ze=We`
  0% {
    opacity: 1;
    background-position: 0 -23px;
  }

  60% {
    opacity: 0;
    background-position: 0 -23px;
  }

  100% {
    opacity: 1;
    background-position: -200px -23px;
  }
`,kt=typeof ze!="string"?ke`
        animation: ${ze} 3s infinite linear;
      `:null,Wt=o=>{const{classes:r,variant:s,color:f}=o,E={root:["root",`color${W(f)}`,s],dashed:["dashed",`dashedColor${W(f)}`],bar1:["bar","bar1",`barColor${W(f)}`,(s==="indeterminate"||s==="query")&&"bar1Indeterminate",s==="determinate"&&"bar1Determinate",s==="buffer"&&"bar1Buffer"],bar2:["bar","bar2",s!=="buffer"&&`barColor${W(f)}`,s==="buffer"&&`color${W(f)}`,(s==="indeterminate"||s==="query")&&"bar2Indeterminate",s==="buffer"&&"bar2Buffer"]};return ot(E,Ct,r)},Se=(o,r)=>o.vars?o.vars.palette.LinearProgress[`${r}Bg`]:o.palette.mode==="light"?o.lighten(o.palette[r].main,.62):o.darken(o.palette[r].main,.5),St=ae("span",{name:"MuiLinearProgress",slot:"Root",overridesResolver:(o,r)=>{const{ownerState:s}=o;return[r.root,r[`color${W(s.color)}`],r[s.variant]]}})(oe(({theme:o})=>({position:"relative",overflow:"hidden",display:"block",height:4,zIndex:0,"@media print":{colorAdjust:"exact"},variants:[...Object.entries(o.palette).filter(K()).map(([r])=>({props:{color:r},style:{backgroundColor:Se(o,r)}})),{props:({ownerState:r})=>r.color==="inherit"&&r.variant!=="buffer",style:{"&::before":{content:'""',position:"absolute",left:0,top:0,right:0,bottom:0,backgroundColor:"currentColor",opacity:.3}}},{props:{variant:"buffer"},style:{backgroundColor:"transparent"}},{props:{variant:"query"},style:{transform:"rotate(180deg)"}}]}))),Rt=ae("span",{name:"MuiLinearProgress",slot:"Dashed",overridesResolver:(o,r)=>{const{ownerState:s}=o;return[r.dashed,r[`dashedColor${W(s.color)}`]]}})(oe(({theme:o})=>({position:"absolute",marginTop:0,height:"100%",width:"100%",backgroundSize:"10px 10px",backgroundPosition:"0 -23px",variants:[{props:{color:"inherit"},style:{opacity:.3,backgroundImage:"radial-gradient(currentColor 0%, currentColor 16%, transparent 42%)"}},...Object.entries(o.palette).filter(K()).map(([r])=>{const s=Se(o,r);return{props:{color:r},style:{backgroundImage:`radial-gradient(${s} 0%, ${s} 16%, transparent 42%)`}}})]})),kt||{animation:`${ze} 3s infinite linear`}),Nt=ae("span",{name:"MuiLinearProgress",slot:"Bar1",overridesResolver:(o,r)=>{const{ownerState:s}=o;return[r.bar,r.bar1,r[`barColor${W(s.color)}`],(s.variant==="indeterminate"||s.variant==="query")&&r.bar1Indeterminate,s.variant==="determinate"&&r.bar1Determinate,s.variant==="buffer"&&r.bar1Buffer]}})(oe(({theme:o})=>({width:"100%",position:"absolute",left:0,bottom:0,top:0,transition:"transform 0.2s linear",transformOrigin:"left",variants:[{props:{color:"inherit"},style:{backgroundColor:"currentColor"}},...Object.entries(o.palette).filter(K()).map(([r])=>({props:{color:r},style:{backgroundColor:(o.vars||o).palette[r].main}})),{props:{variant:"determinate"},style:{transition:`transform .${ve}s linear`}},{props:{variant:"buffer"},style:{zIndex:1,transition:`transform .${ve}s linear`}},{props:({ownerState:r})=>r.variant==="indeterminate"||r.variant==="query",style:{width:"auto"}},{props:({ownerState:r})=>r.variant==="indeterminate"||r.variant==="query",style:wt||{animation:`${Ce} 2.1s cubic-bezier(0.65, 0.815, 0.735, 0.395) infinite`}}]}))),It=ae("span",{name:"MuiLinearProgress",slot:"Bar2",overridesResolver:(o,r)=>{const{ownerState:s}=o;return[r.bar,r.bar2,r[`barColor${W(s.color)}`],(s.variant==="indeterminate"||s.variant==="query")&&r.bar2Indeterminate,s.variant==="buffer"&&r.bar2Buffer]}})(oe(({theme:o})=>({width:"100%",position:"absolute",left:0,bottom:0,top:0,transition:"transform 0.2s linear",transformOrigin:"left",variants:[...Object.entries(o.palette).filter(K()).map(([r])=>({props:{color:r},style:{"--LinearProgressBar2-barColor":(o.vars||o).palette[r].main}})),{props:({ownerState:r})=>r.variant!=="buffer"&&r.color!=="inherit",style:{backgroundColor:"var(--LinearProgressBar2-barColor, currentColor)"}},{props:({ownerState:r})=>r.variant!=="buffer"&&r.color==="inherit",style:{backgroundColor:"currentColor"}},{props:{color:"inherit"},style:{opacity:.3}},...Object.entries(o.palette).filter(K()).map(([r])=>({props:{color:r,variant:"buffer"},style:{backgroundColor:Se(o,r),transition:`transform .${ve}s linear`}})),{props:({ownerState:r})=>r.variant==="indeterminate"||r.variant==="query",style:{width:"auto"}},{props:({ownerState:r})=>r.variant==="indeterminate"||r.variant==="query",style:zt||{animation:`${we} 2.1s cubic-bezier(0.165, 0.84, 0.44, 1) 1.15s infinite`}}]}))),Pt=x.forwardRef(function(r,s){const f=rt({props:r,name:"MuiLinearProgress"}),{className:E,color:ie="primary",value:D,valueBuffer:B,variant:j="indeterminate",...Q}=f,y={...f,color:ie,variant:j},g=Wt(y),V=st(),S={},v={bar1:{},bar2:{}};if((j==="determinate"||j==="buffer")&&D!==void 0){S["aria-valuenow"]=Math.round(D),S["aria-valuemin"]=0,S["aria-valuemax"]=100;let C=D-100;V&&(C=-C),v.bar1.transform=`translateX(${C}%)`}if(j==="buffer"&&B!==void 0){let C=(B||0)-100;V&&(C=-C),v.bar2.transform=`translateX(${C}%)`}return e.jsxs(St,{className:at(g.root,E),ownerState:y,role:"progressbar",...S,ref:s,...Q,children:[j==="buffer"?e.jsx(Rt,{className:g.dashed,ownerState:y}):null,e.jsx(Nt,{className:g.bar1,ownerState:y,style:v.bar1}),j==="determinate"?null:e.jsx(It,{className:g.bar2,ownerState:y,style:v.bar2})]})}),Ve=ne(e.jsx("path",{d:"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2M9 17H7v-7h2zm4 0h-2V7h2zm4 0h-2v-4h2z"})),Dt=ne([e.jsx("path",{d:"M11.99 2C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2M12 20c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8"},"0"),e.jsx("path",{d:"M12.5 7H11v6l5.25 3.15.75-1.23-4.5-2.67z"},"1")]),Tt=ne(e.jsx("path",{d:"M19 3h-1V1h-2v2H8V1H6v2H5c-1.11 0-1.99.9-1.99 2L3 19c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2m0 16H5V8h14zM7 10h5v5H7z"})),Oe=ne(e.jsx("path",{d:"M1 21h22L12 2zm12-3h-2v-2h2zm0-4h-2v-4h2z"}));function ar(){const o=nt(),r=it(o.breakpoints.down("sm")),s=lt(),{error:f,success:E}=ct(),[ie,D]=x.useState(!0),[B,j]=x.useState(!1),[Q,y]=x.useState(null),[g,V]=x.useState(""),[S,v]=x.useState([]),[C,Re]=x.useState(!1),[$t,Ne]=x.useState(!1),_=x.useRef(!1),[p,Ze]=x.useState({patientsCount:0,consultationsCount:0,emailsSentCount:0,patientsThisWeek:0,consultationsThisWeek:0,patientsWithoutConsultation:0}),[le,qe]=x.useState([]),[de,He]=x.useState([]),[ce,Ue]=x.useState([]),[R,Ge]=x.useState([]),[N,Ke]=x.useState([]),[At,Qe]=x.useState({plannedRevenue:0,completedRevenue:0,totalExpectedRevenue:0,visitsThisWeek:{zaplanowana:0,odbyta:0,nieobecnosc:0,anulowana:0}}),[m,T]=x.useState({open:!1,visitId:null,visitData:"",rodzajZabiegu:"",patientName:"",patientEmail:"",customMessage:"",recipientEmail:""}),[X,Ie]=x.useState(!1),_e=async()=>{var t,d;if(m.visitId){if(!m.recipientEmail){f("Podaj adres email odbiorcy");return}try{Ie(!0),await J.post(`/visits/${m.visitId}/reminder`,{recipientEmail:m.recipientEmail,customMessage:m.customMessage||void 0}),E("Przypomnienie wysłane pomyślnie!"),T({open:!1,visitId:null,visitData:"",rodzajZabiegu:"",patientName:"",patientEmail:"",customMessage:"",recipientEmail:""}),Y(!0)}catch(c){f(((d=(t=c.response)==null?void 0:t.data)==null?void 0:d.error)||"Błąd wysyłania przypomnienia")}finally{Ie(!1)}}},xe=async t=>{var c;let d="";try{d=((c=(await J.get(`/patients/${t.patient.id}`)).data.patient)==null?void 0:c.email)||""}catch(h){console.error("Błąd pobierania email pacjenta:",h)}T({open:!0,visitId:t.id,visitData:t.data,rodzajZabiegu:t.rodzajZabiegu,patientName:`${t.patient.firstName} ${t.patient.lastName}`,patientEmail:d,customMessage:"",recipientEmail:d})},Y=x.useCallback(async(t=!1)=>{var d,c,h,I,O,Z,De,Te,$e,Ae;if(!(_.current&&!t))try{_.current=!0,Ne(!0),t?j(!0):D(!0),y(null);const b=(await J.get("/dashboard")).data,$=b.upcomingVisits||[];Ue($),Qe(b.weeklyRevenue||{plannedRevenue:0,completedRevenue:0,totalExpectedRevenue:0,visitsThisWeek:{zaplanowana:0,odbyta:0,nieobecnosc:0,anulowana:0}});const me=new Date,Me=new Date(me.getFullYear(),me.getMonth(),me.getDate()),q=new Date(Me);q.setDate(q.getDate()+1);const he=new Date(q);he.setDate(he.getDate()+1);const Ye=$.filter(ue=>{const H=new Date(ue.data);return H>=Me&&H<q}),Je=$.filter(ue=>{const H=new Date(ue.data);return H>=q&&H<he});Ge(Ye),Ke(Je),Ze(b.stats||{patientsCount:0,consultationsCount:0,emailsSentCount:0,patientsThisWeek:0,consultationsThisWeek:0,patientsWithoutConsultation:0}),qe(b.patientsNeedingAttention||[]),He(b.inactivePatients||[])}catch(l){if(((d=l==null?void 0:l.response)==null?void 0:d.status)===429){const b=((h=(c=l==null?void 0:l.response)==null?void 0:c.headers)==null?void 0:h["retry-after"])||60,$=`Zbyt wiele żądań. Spróbuj ponownie za ${b} sekund.`;y($),f($),setTimeout(()=>{_.current||Y(!0)},b*1e3)}else{const b=((O=(I=l==null?void 0:l.response)==null?void 0:I.data)==null?void 0:O.message)||((De=(Z=l==null?void 0:l.response)==null?void 0:Z.data)==null?void 0:De.error)||(l==null?void 0:l.message)||"Nie udało się załadować danych dashboardu";y(b),f(b),console.error("Failed to fetch dashboard data:",{status:(Te=l==null?void 0:l.response)==null?void 0:Te.status,statusText:($e=l==null?void 0:l.response)==null?void 0:$e.statusText,data:(Ae=l==null?void 0:l.response)==null?void 0:Ae.data,message:l==null?void 0:l.message})}}finally{D(!1),j(!1),Ne(!1),_.current=!1}},[f]);x.useEffect(()=>{Y()},[]),x.useEffect(()=>{if(g.length<2){v([]);return}const t=setTimeout(async()=>{Re(!0);try{const h=((await J.get("/patients")).data.patients||[]).filter(I=>{var O,Z;return`${I.firstName} ${I.lastName}`.toLowerCase().includes(g.toLowerCase())||((O=I.email)==null?void 0:O.toLowerCase().includes(g.toLowerCase()))||((Z=I.phone)==null?void 0:Z.includes(g))}).slice(0,5);v(h)}catch(d){console.error("Search failed",d),v([])}finally{Re(!1)}},300);return()=>clearTimeout(t)},[g]);const pe=t=>{const d=new Date(t),c=String(d.getUTCHours()).padStart(2,"0"),h=String(d.getUTCMinutes()).padStart(2,"0");return`${c}:${h}`},Pe=t=>{const d=new Date(t),c=String(d.getUTCDate()).padStart(2,"0"),h=te(d,"MMM",{locale:re});return`${c} ${h}`};if(ie)return e.jsx(i,{sx:{display:"flex",justifyContent:"center",alignItems:"center",minHeight:"60vh"},children:e.jsx(fe,{size:60,thickness:4})});const Xe=[{title:"Pacjentów",value:p.patientsCount,subtitle:`+${p.patientsThisWeek} w tym tygodniu`,icon:Le,color:"#1976d2",progress:p.patientsThisWeek>0&&p.patientsCount>0?p.patientsThisWeek/p.patientsCount*100:0,link:"/patients"},{title:"Konsultacji",value:p.consultationsCount,subtitle:`+${p.consultationsThisWeek} w tym tygodniu`,icon:dt,color:"#1976d2",progress:p.consultationsThisWeek>0&&p.consultationsCount>0?p.consultationsThisWeek/p.consultationsCount*100:0,link:"/consultations"},{title:"Wizyt dzisiaj",value:R.length,subtitle:`${N.length} jutro`,icon:Fe,color:"#1976d2",progress:0,link:"#visits"},{title:"Bez konsultacji",value:p.patientsWithoutConsultation,subtitle:"Wymaga uwagi",icon:Oe,color:"#d32f2f",progress:p.patientsWithoutConsultation>0&&p.patientsCount>0?p.patientsWithoutConsultation/p.patientsCount*100:0,link:"#attention"}];return e.jsxs(i,{sx:{pb:4},children:[e.jsxs(i,{sx:{mb:{xs:3,sm:4},px:{xs:1,sm:0},display:"flex",justifyContent:"space-between",alignItems:"flex-start",flexWrap:"wrap",gap:2},children:[e.jsxs(i,{children:[e.jsx(a,{variant:"h4",sx:{fontWeight:600,fontSize:{xs:"1.75rem",sm:"2rem"},color:"text.primary",mb:1},children:"Panel Główny"}),e.jsx(a,{variant:"body1",color:"text.secondary",sx:{fontSize:{xs:"0.875rem",sm:"1rem"}},children:te(new Date,"EEEE, d MMMM yyyy",{locale:re})})]}),e.jsxs(i,{sx:{display:"flex",gap:1,flexWrap:"wrap"},children:[e.jsx(xt,{title:"Odśwież dane",children:e.jsx(ee,{onClick:()=>Y(!0),disabled:B,sx:{bgcolor:n("#1976d2",.08),"&:hover":{bgcolor:n("#1976d2",.12)}},children:e.jsx(pt,{sx:{color:"#1976d2",animation:B?"spin 1s linear infinite":"none","@keyframes spin":{"0%":{transform:"rotate(0deg)"},"100%":{transform:"rotate(360deg)"}}}})})}),e.jsx(G,{variant:"contained",startIcon:e.jsx(Ee,{}),onClick:()=>s("/patients/new"),sx:{bgcolor:"#1976d2",color:"white",textTransform:"none",fontWeight:500,borderRadius:2,boxShadow:"none","&:hover":{bgcolor:"#1565c0",boxShadow:"none"}},children:r?"Dodaj":"Dodaj pacjenta"})]})]}),Q&&e.jsx(Be,{severity:"error",sx:{mb:3,mx:{xs:1,sm:0}},onClose:()=>y(null),children:Q}),e.jsxs(P,{sx:{p:{xs:1.5,sm:2},mb:4,mx:{xs:1,sm:0},background:"white",borderRadius:3,border:"1px solid",borderColor:"divider",boxShadow:"0 4px 12px rgba(0,0,0,0.05)"},children:[e.jsx(ye,{fullWidth:!0,placeholder:"Szybkie wyszukiwanie pacjenta...",value:g,onChange:t=>V(t.target.value),size:r?"small":"medium",InputProps:{startAdornment:e.jsx(mt,{position:"start",children:C?e.jsx(fe,{size:20}):e.jsx(ht,{sx:{color:"text.secondary"}})})},sx:{"& .MuiOutlinedInput-root":{borderRadius:3}}}),S.length>0&&e.jsx(A,{sx:{mt:2,p:0},children:S.map(t=>e.jsxs(w,{onClick:()=>{s(`/patients/${t.id}`),V(""),v([])},sx:{borderRadius:3,mb:1,"&:hover":{bgcolor:n("#1976d2",.05)}},children:[e.jsx(F,{children:e.jsxs(M,{sx:{bgcolor:n("#1976d2",.1),color:"#1976d2",fontWeight:600},children:[t.firstName[0],t.lastName[0]]})}),e.jsx(z,{primary:`${t.firstName} ${t.lastName}`,primaryTypographyProps:{fontWeight:600},secondary:t.email||t.phone}),e.jsx(k,{sx:{color:"text.secondary",opacity:.5}})]},t.id))})]}),e.jsx(u,{container:!0,spacing:3,sx:{mb:4,px:{xs:1,sm:0}},children:Xe.map((t,d)=>e.jsx(u,{size:{xs:12,sm:6,md:3},children:e.jsx(ut,{onClick:()=>t.link.startsWith("#")?null:s(t.link),sx:{position:"relative",overflow:"hidden",borderRadius:3,border:"1px solid",borderColor:"divider",boxShadow:"0 4px 20px rgba(0,0,0,0.05)",background:"white",height:"100%",cursor:t.link.startsWith("#")?"default":"pointer",transition:"all 0.2s","&:hover":t.link.startsWith("#")?{}:{transform:"translateY(-4px)",boxShadow:"0 8px 24px rgba(0,0,0,0.1)"},"&::before":{content:'""',position:"absolute",top:0,left:0,right:0,height:"3px",background:t.color,borderRadius:"16px 16px 0 0"}},children:e.jsxs(ft,{sx:{p:3,overflow:"hidden"},children:[e.jsx(i,{sx:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",mb:2},children:e.jsx(i,{sx:{width:48,height:48,borderRadius:"8px",background:n(t.color,.1),display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(t.icon,{sx:{color:t.color,fontSize:24}})})}),e.jsx(a,{variant:"h3",sx:{fontWeight:600,mb:.5,fontSize:{xs:"2rem",sm:"2.5rem"},color:"text.primary"},children:t.value}),e.jsx(a,{variant:"body2",color:"text.secondary",sx:{fontWeight:600,mb:1},children:t.title}),e.jsx(a,{variant:"caption",color:"text.secondary",sx:{fontWeight:500,mb:t.progress>0?2:0,display:"block"},children:t.subtitle}),t.progress>0&&e.jsx(i,{sx:{mt:2,width:"100%",overflow:"hidden",borderRadius:1},children:e.jsx(Pt,{variant:"determinate",value:Math.min(t.progress,100),sx:{height:8,borderRadius:4,bgcolor:n(t.color,.1),"& .MuiLinearProgress-bar":{background:t.color,borderRadius:4}}})})]})})},d))}),e.jsx(u,{container:!0,spacing:3,sx:{mb:4,px:{xs:1,sm:0}},children:e.jsx(u,{size:{xs:12},children:e.jsxs(P,{sx:{p:{xs:2,sm:2.5},borderRadius:3,background:"white",border:"1px solid",borderColor:"divider",boxShadow:"0 2px 8px rgba(0,0,0,0.08)"},children:[e.jsx(a,{variant:"h6",sx:{fontWeight:600,mb:2,color:"text.primary"},children:"Szybkie akcje"}),e.jsxs(u,{container:!0,spacing:2,children:[e.jsx(u,{size:{xs:12,sm:4},children:e.jsxs(w,{onClick:()=>s("/patients/new"),sx:{borderRadius:2,border:"1px solid",borderColor:"divider",py:1.5,transition:"all 0.2s","&:hover":{bgcolor:n("#1976d2",.05),borderColor:"#1976d2"}},children:[e.jsx(ge,{children:e.jsx(Le,{sx:{color:"#1976d2"}})}),e.jsx(z,{primary:"Dodaj pacjenta",primaryTypographyProps:{fontWeight:500,color:"text.primary"}}),e.jsx(k,{sx:{color:"text.secondary",opacity:.5}})]})}),e.jsx(u,{size:{xs:12,sm:4},children:e.jsxs(w,{onClick:()=>s("/visits/new"),sx:{borderRadius:2,border:"1px solid",borderColor:"divider",py:1.5,transition:"all 0.2s","&:hover":{bgcolor:n("#1976d2",.05),borderColor:"#1976d2"}},children:[e.jsx(ge,{children:e.jsx(Fe,{sx:{color:"#1976d2"}})}),e.jsx(z,{primary:"Nowa wizyta",primaryTypographyProps:{fontWeight:500,color:"text.primary"}}),e.jsx(k,{sx:{color:"text.secondary",opacity:.5}})]})}),e.jsx(u,{size:{xs:12,sm:4},children:e.jsxs(w,{onClick:()=>s("/patients"),sx:{borderRadius:2,border:"1px solid",borderColor:"divider",py:1.5,transition:"all 0.2s","&:hover":{bgcolor:n("#1976d2",.05),borderColor:"#1976d2"}},children:[e.jsx(ge,{children:e.jsx(Ve,{sx:{color:"#1976d2"}})}),e.jsx(z,{primary:"Lista pacjentów",primaryTypographyProps:{fontWeight:500,color:"text.primary"}}),e.jsx(k,{sx:{color:"text.secondary",opacity:.5}})]})})]})]})})}),(R.length>0||N.length>0||ce.length>0)&&e.jsxs(i,{id:"visits",sx:{mb:4,px:{xs:1,sm:0}},children:[e.jsxs(i,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2},children:[e.jsx(a,{variant:"h5",sx:{fontWeight:700},children:"Nadchodzące wizyty"}),e.jsx(G,{variant:"outlined",startIcon:e.jsx(Ee,{}),onClick:()=>s("/patients"),size:"small",sx:{textTransform:"none",fontWeight:600,borderRadius:2},children:"Dodaj wizytę"})]}),e.jsxs(u,{container:!0,spacing:3,children:[R.length>0&&e.jsx(u,{size:{xs:12,md:6},children:e.jsxs(P,{sx:{p:{xs:2,sm:3},background:"white",borderRadius:3,border:"2px solid",borderColor:"#1976d2",boxShadow:`0 8px 24px ${n("#1976d2",.15)}`},children:[e.jsxs(i,{sx:{display:"flex",alignItems:"center",gap:1.5,mb:2},children:[e.jsx(Tt,{sx:{color:"#1976d2",fontSize:28}}),e.jsxs(i,{children:[e.jsx(a,{variant:"h6",sx:{fontWeight:700,color:"#1976d2"},children:"Dzisiaj"}),e.jsxs(a,{variant:"caption",color:"text.secondary",children:[R.length," ",R.length===1?"wizyta":"wizyt"]})]})]}),e.jsx(A,{sx:{p:0},children:R.map((t,d)=>{const c=L[t.status]||L.ZAPLANOWANA;return e.jsxs(U.Fragment,{children:[d>0&&e.jsx(be,{sx:{my:1}}),e.jsxs(w,{onClick:()=>s(`/patients/${t.patient.id}`),sx:{borderRadius:2,"&:hover":{bgcolor:n("#1976d2",.05)}},children:[e.jsx(F,{children:e.jsxs(M,{sx:{bgcolor:n("#1976d2",.1),color:"#1976d2",fontWeight:600},children:[t.patient.firstName[0],t.patient.lastName[0]]})}),e.jsx(z,{primary:e.jsxs(i,{sx:{display:"flex",alignItems:"center",gap:1,flexWrap:"wrap"},children:[e.jsxs(a,{variant:"body1",sx:{fontWeight:600},children:[t.patient.firstName," ",t.patient.lastName]}),e.jsx(je,{label:c.label,size:"small",sx:{bgcolor:c.bgColor,color:c.color,fontWeight:600,fontSize:"0.7rem",height:20}})]}),secondary:e.jsxs(i,{sx:{display:"flex",alignItems:"center",gap:1,flexWrap:"wrap",mt:.5},children:[e.jsx(a,{variant:"body2",color:"text.secondary",children:t.rodzajZabiegu}),e.jsx(a,{variant:"caption",sx:{color:"#1976d2",fontWeight:600},children:pe(t.data)}),t.cena&&e.jsxs(a,{variant:"caption",sx:{bgcolor:n("#34C759",.1),color:"#34C759",px:1,borderRadius:1,fontWeight:600},children:[Number(t.cena).toFixed(0)," zł"]})]})}),e.jsxs(i,{sx:{display:"flex",alignItems:"center",gap:.5},children:[e.jsx(ee,{size:"small",onClick:h=>{h.stopPropagation(),xe(t)},sx:{color:"#FF9500","&:hover":{bgcolor:n("#FF9500",.1)}},children:e.jsx(se,{fontSize:"small"})}),e.jsx(k,{sx:{color:"#1976d2",opacity:.5}})]})]})]},t.id)})})]})}),N.length>0&&e.jsx(u,{size:{xs:12,md:6},children:e.jsxs(P,{sx:{p:{xs:2,sm:3},background:"white",borderRadius:3,border:"1px solid",borderColor:n("#1976d2",.3),boxShadow:`0 8px 24px ${n("#1976d2",.1)}`},children:[e.jsxs(i,{sx:{display:"flex",alignItems:"center",gap:1.5,mb:2},children:[e.jsx(Dt,{sx:{color:"#1976d2",fontSize:28}}),e.jsxs(i,{children:[e.jsx(a,{variant:"h6",sx:{fontWeight:700,color:"#1976d2"},children:"Jutro"}),e.jsxs(a,{variant:"caption",color:"text.secondary",children:[N.length," ",N.length===1?"wizyta":"wizyt"]})]})]}),e.jsx(A,{sx:{p:0},children:N.map((t,d)=>{const c=L[t.status]||L.ZAPLANOWANA;return e.jsxs(U.Fragment,{children:[d>0&&e.jsx(be,{sx:{my:1}}),e.jsxs(w,{onClick:()=>s(`/patients/${t.patient.id}`),sx:{borderRadius:2,"&:hover":{bgcolor:n("#1976d2",.05)}},children:[e.jsx(F,{children:e.jsxs(M,{sx:{bgcolor:n("#1976d2",.1),color:"#1976d2",fontWeight:600},children:[t.patient.firstName[0],t.patient.lastName[0]]})}),e.jsx(z,{primary:e.jsxs(i,{sx:{display:"flex",alignItems:"center",gap:1,flexWrap:"wrap"},children:[e.jsxs(a,{variant:"body1",sx:{fontWeight:600},children:[t.patient.firstName," ",t.patient.lastName]}),e.jsx(je,{label:c.label,size:"small",sx:{bgcolor:c.bgColor,color:c.color,fontWeight:600,fontSize:"0.7rem",height:20}})]}),secondary:e.jsxs(i,{sx:{display:"flex",alignItems:"center",gap:1,flexWrap:"wrap",mt:.5},children:[e.jsx(a,{variant:"body2",color:"text.secondary",children:t.rodzajZabiegu}),e.jsxs(a,{variant:"caption",sx:{color:"#1976d2",fontWeight:600},children:[Pe(t.data),", ",pe(t.data)]}),t.cena&&e.jsxs(a,{variant:"caption",sx:{bgcolor:n("#34C759",.1),color:"#34C759",px:1,borderRadius:1,fontWeight:600},children:[Number(t.cena).toFixed(0)," zł"]})]})}),e.jsxs(i,{sx:{display:"flex",alignItems:"center",gap:.5},children:[e.jsx(ee,{size:"small",onClick:h=>{h.stopPropagation(),xe(t)},sx:{color:"#FF9500","&:hover":{bgcolor:n("#FF9500",.1)}},children:e.jsx(se,{fontSize:"small"})}),e.jsx(k,{sx:{color:"#1976d2",opacity:.5}})]})]})]},t.id)})})]})}),R.length===0&&N.length===0&&ce.length>0&&e.jsx(u,{size:{xs:12},children:e.jsxs(P,{sx:{p:{xs:2,sm:3},background:"white",borderRadius:3,border:"1px solid",borderColor:n("#1976d2",.3),boxShadow:`0 8px 24px ${n("#1976d2",.1)}`},children:[e.jsxs(i,{sx:{display:"flex",alignItems:"center",gap:2,mb:3},children:[e.jsx(gt,{sx:{color:"#1976d2",fontSize:{xs:24,sm:32}}}),e.jsxs(i,{children:[e.jsx(a,{variant:"h6",sx:{fontWeight:700,color:"#1976d2",fontSize:{xs:"1rem",sm:"1.25rem"}},children:"Nadchodzące wizyty i zabiegi"}),e.jsx(a,{variant:"body2",color:"text.secondary",children:"Najbliższe zaplanowane wizyty"})]})]}),e.jsx(A,{sx:{p:0},children:ce.slice(0,6).map((t,d)=>{const c=L[t.status]||L.ZAPLANOWANA;return e.jsxs(U.Fragment,{children:[d>0&&e.jsx(be,{sx:{my:1}}),e.jsxs(w,{onClick:()=>s(`/patients/${t.patient.id}`),sx:{borderRadius:2,"&:hover":{bgcolor:n("#1976d2",.05)}},children:[e.jsx(F,{children:e.jsxs(M,{sx:{bgcolor:n("#1976d2",.1),color:"#1976d2",fontWeight:600},children:[t.patient.firstName[0],t.patient.lastName[0]]})}),e.jsx(z,{primary:e.jsxs(i,{sx:{display:"flex",alignItems:"center",gap:1,flexWrap:"wrap"},children:[e.jsxs(a,{variant:"body1",sx:{fontWeight:600},children:[t.patient.firstName," ",t.patient.lastName]}),e.jsx(je,{label:c.label,size:"small",sx:{bgcolor:c.bgColor,color:c.color,fontWeight:600,fontSize:"0.7rem",height:20}})]}),secondary:e.jsxs(i,{sx:{display:"flex",alignItems:"center",gap:1,flexWrap:"wrap",mt:.5},children:[e.jsx(a,{variant:"body2",color:"text.secondary",children:t.rodzajZabiegu}),e.jsxs(a,{variant:"caption",sx:{color:"#1976d2",fontWeight:600},children:[Pe(t.data),", ",pe(t.data)]}),t.numerWSerii&&t.liczbaSerii&&e.jsxs(a,{variant:"caption",sx:{bgcolor:n("#007AFF",.1),color:"#007AFF",px:1,borderRadius:1,fontWeight:600},children:[t.numerWSerii,"/",t.liczbaSerii]}),t.cena&&e.jsxs(a,{variant:"caption",sx:{bgcolor:n("#34C759",.1),color:"#34C759",px:1,borderRadius:1,fontWeight:600},children:[Number(t.cena).toFixed(0)," zł"]})]})}),e.jsxs(i,{sx:{display:"flex",alignItems:"center",gap:.5},children:[e.jsx(ee,{size:"small",onClick:h=>{h.stopPropagation(),xe(t)},sx:{color:"#FF9500","&:hover":{bgcolor:n("#FF9500",.1)}},children:e.jsx(se,{fontSize:"small"})}),e.jsx(k,{sx:{color:"#1976d2",opacity:.5}})]})]})]},t.id)})})]})})]})]}),(le.length>0||de.length>0)&&e.jsx(i,{id:"attention",sx:{mb:4,px:{xs:1,sm:0}},children:e.jsxs(u,{container:!0,spacing:3,children:[le.length>0&&e.jsx(u,{size:{xs:12,md:6},children:e.jsxs(P,{sx:{p:{xs:2,sm:3},background:"white",borderRadius:3,border:"1px solid",borderColor:n("#d32f2f",.3),boxShadow:`0 8px 24px ${n("#d32f2f",.1)}`},children:[e.jsxs(i,{sx:{display:"flex",alignItems:"center",gap:2,mb:3},children:[e.jsx(Oe,{sx:{color:"#d32f2f",fontSize:{xs:24,sm:32}}}),e.jsxs(i,{children:[e.jsx(a,{variant:"h6",sx:{fontWeight:700,color:"#d32f2f",fontSize:{xs:"1rem",sm:"1.25rem"}},children:"Pacjenci bez konsultacji"}),e.jsxs(a,{variant:"body2",color:"text.secondary",children:[p.patientsWithoutConsultation," pacjentów wymaga uwagi"]})]})]}),e.jsx(A,{sx:{p:0},children:le.map(t=>e.jsx(U.Fragment,{children:e.jsxs(w,{onClick:()=>s(`/patients/${t.id}`),sx:{borderRadius:2,mb:.5,"&:hover":{bgcolor:n("#d32f2f",.05)}},children:[e.jsx(F,{children:e.jsxs(M,{sx:{bgcolor:n("#d32f2f",.1),color:"#d32f2f",fontWeight:600},children:[t.firstName[0],t.lastName[0]]})}),e.jsx(z,{primary:e.jsxs(a,{variant:"body1",sx:{fontWeight:600},children:[t.firstName," ",t.lastName]}),secondary:e.jsxs(a,{variant:"caption",color:"text.secondary",children:["Dodany: ",te(new Date(t.createdAt),"dd MMM yyyy",{locale:re})]})}),e.jsx(k,{sx:{color:"#d32f2f",opacity:.5}})]})},t.id))}),e.jsx(G,{fullWidth:!0,variant:"outlined",onClick:()=>s("/patients"),sx:{mt:2,borderRadius:2,textTransform:"none",fontWeight:600,borderColor:"#d32f2f",color:"#d32f2f","&:hover":{borderColor:"#d32f2f",bgcolor:n("#d32f2f",.05)}},children:"Zobacz wszystkich"})]})}),de.length>0&&e.jsx(u,{size:{xs:12,md:6},children:e.jsxs(P,{sx:{p:{xs:2,sm:3},background:"white",borderRadius:3,border:"1px solid",borderColor:n("#1976d2",.3),boxShadow:`0 8px 24px ${n("#1976d2",.1)}`},children:[e.jsxs(i,{sx:{display:"flex",alignItems:"center",gap:2,mb:3},children:[e.jsx(Ve,{sx:{color:"#1976d2",fontSize:{xs:24,sm:32}}}),e.jsxs(i,{children:[e.jsx(a,{variant:"h6",sx:{fontWeight:700,color:"#1976d2",fontSize:{xs:"1rem",sm:"1.25rem"}},children:"Pacjenci nieaktywni"}),e.jsx(a,{variant:"body2",color:"text.secondary",children:"Brak konsultacji przez 30+ dni"})]})]}),e.jsx(A,{sx:{p:0},children:de.map(t=>e.jsx(U.Fragment,{children:e.jsxs(w,{onClick:()=>s(`/patients/${t.id}`),sx:{borderRadius:2,mb:.5,"&:hover":{bgcolor:n("#1976d2",.05)}},children:[e.jsx(F,{children:e.jsxs(M,{sx:{bgcolor:n("#1976d2",.1),color:"#1976d2",fontWeight:600},children:[t.firstName[0],t.lastName[0]]})}),e.jsx(z,{primary:e.jsxs(a,{variant:"body1",sx:{fontWeight:600},children:[t.firstName," ",t.lastName]}),secondary:e.jsxs(a,{variant:"caption",color:"text.secondary",children:["Dodany: ",te(new Date(t.createdAt),"dd MMM yyyy",{locale:re})]})}),e.jsx(k,{sx:{color:"#1976d2",opacity:.5}})]})},t.id))})]})})]})}),e.jsxs(bt,{open:m.open,onClose:()=>T({...m,open:!1}),maxWidth:"sm",fullWidth:!0,PaperProps:{sx:{borderRadius:3,p:1}},children:[e.jsx(yt,{sx:{fontWeight:600,pb:2},children:"Wyślij przypomnienie o wizycie"}),e.jsxs(jt,{children:[e.jsxs(i,{sx:{mb:2},children:[e.jsx(a,{variant:"body2",color:"text.secondary",gutterBottom:!0,children:"Pacjent:"}),e.jsx(a,{variant:"h6",sx:{fontWeight:600,mb:1},children:m.patientName}),e.jsx(a,{variant:"body2",color:"text.secondary",gutterBottom:!0,children:"Wizyta:"}),e.jsx(a,{variant:"body1",sx:{fontWeight:500,mb:1},children:m.rodzajZabiegu}),e.jsx(a,{variant:"body2",color:"text.secondary",children:m.visitData?new Date(m.visitData).toLocaleString("pl-PL",{weekday:"long",year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}):""})]}),e.jsx(ye,{fullWidth:!0,label:"Adres email odbiorcy",type:"email",value:m.recipientEmail,onChange:t=>T({...m,recipientEmail:t.target.value}),required:!0,sx:{mb:2},helperText:m.patientEmail?"Email pacjenta":"Pacjent nie ma zapisanego adresu email"}),e.jsx(ye,{fullWidth:!0,label:"Dodatkowa wiadomość (opcjonalnie)",multiline:!0,rows:4,value:m.customMessage,onChange:t=>T({...m,customMessage:t.target.value}),placeholder:"Dodaj dodatkową wiadomość do przypomnienia...",sx:{mb:2}}),e.jsx(Be,{severity:"info",sx:{mt:2},children:"Pacjent otrzyma email z przypomnieniem oraz możliwością zapisania wizyty do kalendarza (Google Calendar, Outlook, lub plik .ics)."})]}),e.jsxs(vt,{sx:{p:2,pt:1},children:[e.jsx(G,{onClick:()=>T({...m,open:!1}),disabled:X,children:"Anuluj"}),e.jsx(G,{onClick:_e,variant:"contained",startIcon:X?e.jsx(fe,{size:20}):e.jsx(se,{}),disabled:X||!m.recipientEmail,sx:{bgcolor:"#FF9500","&:hover":{bgcolor:"#E68900"}},children:X?"Wysyłanie...":"Wyślij przypomnienie"})]})]})]})}export{ar as default};
