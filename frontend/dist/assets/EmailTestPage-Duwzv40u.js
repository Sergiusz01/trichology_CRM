import{r as u,j as e,B as h,T as s,P as g,C as v,q as j}from"./index-ik9JjyS6.js";import{G as f}from"./Grid-OOY2WAvo.js";import{B as y}from"./Button-B6n5coYQ.js";import{A as S}from"./Alert-Dzq7_ew3.js";import{C as b}from"./CheckCircle-BAaxyyx0.js";import{E as z}from"./Error-BJgDBAdx.js";import{T as C}from"./TextField-BNTsiTHM.js";import{S as B}from"./Send-CFne59d_.js";import"./useThemeProps-C_QfMg4i.js";import"./Select--zggdXop.js";function H(){const[l,T]=u.useState(""),[d,m]=u.useState(!1),[a,x]=u.useState({checked:!1,success:!1,message:""}),[p,i]=u.useState(null),k=async()=>{var r,c,n,o;m(!0),x({checked:!1,success:!1,message:""}),i(null);try{const t=await j.get("/email/test-connection");x({checked:!0,success:t.data.success,message:t.data.message,config:t.data.config})}catch(t){x({checked:!0,success:!1,message:((c=(r=t.response)==null?void 0:r.data)==null?void 0:c.message)||"Błąd sprawdzania połączenia",config:(o=(n=t.response)==null?void 0:n.data)==null?void 0:o.config})}finally{m(!1)}},w=async()=>{var r,c,n,o;if(!l){i({success:!1,message:"Podaj adres email"});return}m(!0),i(null);try{await j.post("/email/test",{to:l}),i({success:!0,message:"Testowy email wysłany pomyślnie! Sprawdź skrzynkę odbiorczą."})}catch(t){i({success:!1,message:((c=(r=t.response)==null?void 0:r.data)==null?void 0:c.error)||((o=(n=t.response)==null?void 0:n.data)==null?void 0:o.message)||"Błąd wysyłania emaila"})}finally{m(!1)}};return e.jsxs(h,{children:[e.jsx(s,{variant:"h4",gutterBottom:!0,children:"Test konfiguracji email"}),e.jsxs(f,{container:!0,spacing:3,children:[e.jsx(f,{item:!0,xs:12,md:6,children:e.jsxs(g,{sx:{p:3},children:[e.jsx(s,{variant:"h6",gutterBottom:!0,children:"Test połączenia SMTP"}),e.jsx(s,{variant:"body2",color:"text.secondary",sx:{mb:2},children:"Sprawdź czy konfiguracja email działa poprawnie"}),e.jsx(y,{variant:"contained",onClick:k,disabled:d,sx:{mb:2},children:d?e.jsx(v,{size:20}):"Sprawdź połączenie"}),a.checked&&e.jsxs(S,{severity:a.success?"success":"error",icon:a.success?e.jsx(b,{}):e.jsx(z,{}),sx:{mt:2},children:[a.message,a.config&&e.jsxs(h,{sx:{mt:2,fontSize:"0.875rem"},children:[e.jsx(s,{variant:"subtitle2",sx:{mt:1},children:"Konfiguracja:"}),e.jsxs(s,{children:["Host: ",a.config.host]}),e.jsxs(s,{children:["Port: ",a.config.port]}),e.jsxs(s,{children:["Secure: ",a.config.secure?"Tak":"Nie (STARTTLS)"]}),e.jsxs(s,{children:["User: ",a.config.user]}),e.jsxs(s,{children:["From: ",a.config.from]})]})]})]})}),e.jsx(f,{item:!0,xs:12,md:6,children:e.jsxs(g,{sx:{p:3},children:[e.jsx(s,{variant:"h6",gutterBottom:!0,children:"Wyślij testowy email"}),e.jsx(s,{variant:"body2",color:"text.secondary",sx:{mb:2},children:"Wyślij testowy email na podany adres"}),e.jsx(C,{fullWidth:!0,label:"Adres email",type:"email",value:l,onChange:r=>T(r.target.value),placeholder:"test@example.com",sx:{mb:2}}),e.jsx(y,{variant:"contained",startIcon:e.jsx(B,{}),onClick:w,disabled:d||!l,children:d?"Wysyłanie...":"Wyślij testowy email"}),p&&e.jsx(S,{severity:p.success?"success":"error",sx:{mt:2},children:p.message})]})})]})]})}export{H as default};
