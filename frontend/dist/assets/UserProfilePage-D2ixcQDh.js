import{c as A,j as e,u as I,r as a,n as Z,o as H,B as w,T as f,D as W,q as D}from"./index-ik9JjyS6.js";import{G as j}from"./Grid-OOY2WAvo.js";import{C as k}from"./Card-CoKfBisl.js";import{C as E}from"./CardContent-IdCV6dAg.js";import{A as c}from"./Alert-Dzq7_ew3.js";import{T as i}from"./TextField-BNTsiTHM.js";import{B as q}from"./Button-B6n5coYQ.js";import{S as V}from"./Save-BBUZJYPl.js";import"./useThemeProps-C_QfMg4i.js";import"./Select--zggdXop.js";const G=A(e.jsx("path",{d:"M18 8h-1V6c0-2.76-2.24-5-5-5S7 3.24 7 6v2H6c-1.1 0-2 .9-2 2v10c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V10c0-1.1-.9-2-2-2m-6 9c-1.1 0-2-.9-2-2s.9-2 2-2 2 .9 2 2-.9 2-2 2m3.1-9H8.9V6c0-1.71 1.39-3.1 3.1-3.1s3.1 1.39 3.1 3.1z"}));function Y(){const{user:l}=I(),[P,d]=a.useState(!1),B=Z(),u=H(B.breakpoints.down("sm")),[t,h]=a.useState({name:"",email:""}),[r,m]=a.useState({currentPassword:"",newPassword:"",confirmPassword:""}),[g,v]=a.useState(""),[y,b]=a.useState(""),[z,x]=a.useState(""),[S,C]=a.useState("");a.useEffect(()=>{l&&h({name:l.name||"",email:l.email||""})},[l]);const T=async s=>{var o,n;s.preventDefault();try{d(!0),v(""),b(""),await D.put("/user-profile/me",t),b("Profil został zaktualizowany")}catch(p){v(((n=(o=p.response)==null?void 0:o.data)==null?void 0:n.error)||"Wystąpił błąd podczas aktualizacji profilu")}finally{d(!1)}},M=async s=>{var o,n;s.preventDefault();try{if(d(!0),x(""),C(""),r.newPassword!==r.confirmPassword){x("Nowe hasła nie są identyczne");return}await D.post("/user-profile/me/change-password",{currentPassword:r.currentPassword,newPassword:r.newPassword}),C("Hasło zostało zmienione"),m({currentPassword:"",newPassword:"",confirmPassword:""})}catch(p){x(((n=(o=p.response)==null?void 0:o.data)==null?void 0:n.error)||"Wystąpił błąd podczas zmiany hasła")}finally{d(!1)}};return e.jsxs(w,{sx:{width:"100%",maxWidth:"100%",overflow:"hidden"},children:[e.jsx(f,{variant:"h4",sx:{mb:{xs:2,sm:3},fontSize:{xs:"1.5rem",sm:"2rem"},fontWeight:"bold"},children:"Mój profil"}),e.jsxs(j,{container:!0,spacing:{xs:2,sm:3},children:[e.jsx(j,{item:!0,xs:12,md:6,children:e.jsx(k,{children:e.jsxs(E,{children:[e.jsx(f,{variant:"h6",gutterBottom:!0,children:"Dane osobowe"}),e.jsx(W,{sx:{mb:2}}),g&&e.jsx(c,{severity:"error",sx:{mb:2},children:g}),y&&e.jsx(c,{severity:"success",sx:{mb:2},children:y}),e.jsxs("form",{onSubmit:T,children:[e.jsx(i,{label:"Imię i nazwisko",value:t.name,onChange:s=>h({...t,name:s.target.value}),fullWidth:!0,required:!0,margin:"normal"}),e.jsx(i,{label:"Email",type:"email",value:t.email,onChange:s=>h({...t,email:s.target.value}),fullWidth:!0,required:!0,margin:"normal"}),e.jsx(w,{sx:{mt:2},children:e.jsx(q,{type:"submit",variant:"contained",startIcon:e.jsx(V,{}),disabled:P,children:"Zapisz zmiany"})})]})]})})}),e.jsx(j,{item:!0,xs:12,md:6,children:e.jsx(k,{children:e.jsxs(E,{children:[e.jsx(f,{variant:"h6",gutterBottom:!0,children:"Zmiana hasła"}),e.jsx(W,{sx:{mb:2}}),z&&e.jsx(c,{severity:"error",sx:{mb:2},children:z}),S&&e.jsx(c,{severity:"success",sx:{mb:2},children:S}),e.jsxs("form",{onSubmit:M,children:[e.jsx(i,{label:"Aktualne hasło",type:"password",value:r.currentPassword,onChange:s=>m({...r,currentPassword:s.target.value}),fullWidth:!0,required:!0,margin:"normal"}),e.jsx(i,{label:"Nowe hasło",type:"password",value:r.newPassword,onChange:s=>m({...r,newPassword:s.target.value}),fullWidth:!0,required:!0,margin:"normal",helperText:"Minimum 6 znaków"}),e.jsx(i,{label:"Potwierdź nowe hasło",type:"password",value:r.confirmPassword,onChange:s=>m({...r,confirmPassword:s.target.value}),fullWidth:!0,required:!0,margin:"normal"}),e.jsx(w,{sx:{mt:2},children:e.jsx(q,{type:"submit",variant:"contained",startIcon:e.jsx(G,{}),disabled:P,fullWidth:u,size:u?"medium":"large",sx:{fontSize:{xs:"0.875rem",sm:"1rem"},py:{xs:1.25,sm:1.5}},children:"Zmień hasło"})})]})]})})})]})]})}export{Y as default};
