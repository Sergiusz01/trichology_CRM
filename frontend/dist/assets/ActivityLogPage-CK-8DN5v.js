import{c as v,j as e,r as c,p as D,n as z,o as W,q as B,B as o,T as r,P as V,C as H,L as M,R as F,D as G,a2 as q,t as l,A as p,w as J,I as R,E as L,y as K,S as Q}from"./index-ik9JjyS6.js";import{B as Z}from"./Button-B6n5coYQ.js";import{R as $}from"./Refresh-F-fXWn1Z.js";import{A as f}from"./Alert-Dzq7_ew3.js";import{L as X,A as P,P as Y}from"./PersonAdd-D_WekEfC.js";import{f as y,l as C}from"./index-B-6z-uVP.js";import{T as S}from"./TablePagination-CsvtqNHM.js";import{T as ee,a as se,b as ae,c as w,d as t,e as re}from"./TableRow-D3npZos0.js";import{E as h}from"./Edit-DimIYhJX.js";import{A as te}from"./Assignment-kAkaYihh.js";import{P as ie}from"./PhotoCamera-DoXIfpUv.js";import{C as ne}from"./CalendarToday-DUEIO3Zn.js";import"./KeyboardArrowRight-BF2dHtf7.js";import"./Select--zggdXop.js";import"./MenuItem-cD7WzH5Q.js";const oe=v(e.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2m1 15h-2v-6h2zm0-8h-2V7h2z"})),ce=v(e.jsx("path",{d:"M11 7 9.6 8.4l2.6 2.6H2v2h10.2l-2.6 2.6L11 17l5-5zm9 12h-8v2h8c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2h-8v2h8z"}));function b(a){if(a==="LOGIN")return e.jsx(ce,{});switch(a){case"PATIENT":case"CREATE_PATIENT":case"RESTORE_PATIENT":return e.jsx(Y,{});case"UPDATE_PATIENT":case"ARCHIVE_PATIENT":case"DELETE_PATIENT":case"PATIENT_EDIT":return e.jsx(h,{});case"CONSULTATION":case"CREATE_CONSULTATION":case"RESTORE_CONSULTATION":case"CONSULTATION_EDIT":return e.jsx(L,{});case"UPDATE_CONSULTATION":case"ARCHIVE_CONSULTATION":case"DELETE_CONSULTATION":return e.jsx(h,{});case"VISIT":case"CREATE_VISIT":case"UPDATE_VISIT":case"UPDATE_VISIT_STATUS":case"DELETE_VISIT":case"VISIT_EDIT":return e.jsx(ne,{});case"LAB_RESULT":case"CREATE_LAB_RESULT":case"RESTORE_LAB_RESULT":case"LAB_RESULT_EDIT":return e.jsx(Q,{});case"UPDATE_LAB_RESULT":case"ARCHIVE_LAB_RESULT":case"DELETE_LAB_RESULT":return e.jsx(h,{});case"SCALP_PHOTO":return e.jsx(ie,{});case"CARE_PLAN":case"CREATE_CARE_PLAN":case"RESTORE_CARE_PLAN":case"CARE_PLAN_EDIT":return e.jsx(te,{});case"UPDATE_CARE_PLAN":case"ARCHIVE_CARE_PLAN":case"DELETE_CARE_PLAN":return e.jsx(h,{});case"EMAIL":return e.jsx(K,{});default:return e.jsx(L,{})}}function N(a){return a==="LOGIN"?"#2e7d32":a.startsWith("PATIENT")||a==="CREATE_PATIENT"||a==="RESTORE_PATIENT"?"#1976d2":a.startsWith("CONSULTATION")||a==="CREATE_CONSULTATION"||a==="RESTORE_CONSULTATION"?"#d32f2f":a.startsWith("VISIT")||a==="CREATE_VISIT"||a==="UPDATE_VISIT"||a==="UPDATE_VISIT_STATUS"||a==="DELETE_VISIT"?"#34C759":a.startsWith("LAB_RESULT")||a==="CREATE_LAB_RESULT"||a==="RESTORE_LAB_RESULT"?"#FF9500":a==="SCALP_PHOTO"?"#AF52DE":a.startsWith("CARE_PLAN")||a==="CREATE_CARE_PLAN"||a==="RESTORE_CARE_PLAN"?"#007AFF":"#1976d2"}function Le(){const[a,k]=c.useState([]),[j,g]=c.useState(!0),[m,E]=c.useState(null),[x,T]=c.useState(0),[d,u]=c.useState(50),I=D(),O=z(),U=W(O.breakpoints.down("md")),A=c.useCallback(async()=>{var s,i;try{g(!0),E(null);const n=await B.get("/activity",{params:{limit:2e3}});k(n.data.activities??[])}catch(n){E(((i=(s=n==null?void 0:n.response)==null?void 0:s.data)==null?void 0:i.message)||(n==null?void 0:n.message)||"Nie udało się załadować dziennika aktywności.")}finally{g(!1)}},[]);c.useEffect(()=>{A()},[A]);const _=a.slice(x*d,x*d+d);return e.jsxs(o,{sx:{width:"100%",maxWidth:"100%",py:{xs:2,sm:3},px:{xs:1,sm:2,md:3}},children:[e.jsx(o,{sx:{mb:3},children:e.jsxs(o,{sx:{display:"flex",flexDirection:{xs:"column",sm:"row"},justifyContent:"space-between",alignItems:{xs:"flex-start",sm:"center"},gap:2},children:[e.jsxs(o,{children:[e.jsx(r,{variant:"h5",sx:{fontWeight:700},children:"Dziennik aktywności"}),e.jsx(r,{variant:"body2",color:"text.secondary",sx:{mt:.5},children:"Wszystkie zdarzenia w systemie: logowania, kto się zalogował, dodane i zmienione rekordy (pacjenci, wizyty, konsultacje, wyniki badań, plany opieki)."})]}),e.jsx(Z,{startIcon:e.jsx($,{}),onClick:A,variant:"outlined",disabled:j,sx:{textTransform:"none",fontWeight:600},children:"Odśwież"})]})}),e.jsxs(f,{severity:"info",icon:e.jsx(oe,{}),sx:{mb:2},children:[e.jsx("strong",{children:"Co jest rejestrowane:"})," logowania użytkowników (kto, kiedy), dodawanie i edycja pacjentów, wizyt, konsultacji, wyników badań i planów opieki, archiwizowanie oraz przywracanie. Użyj tego widoku do weryfikacji aktywności w systemie."]}),m&&e.jsx(f,{severity:"error",sx:{mb:2},onClose:()=>E(null),children:m}),e.jsx(V,{sx:{p:{xs:2,sm:3},borderRadius:3,border:"1px solid",borderColor:"divider",boxShadow:"0 4px 12px rgba(0,0,0,0.05)",overflow:"hidden"},children:j?e.jsx(o,{sx:{display:"flex",justifyContent:"center",py:6},children:e.jsx(H,{})}):a.length===0?e.jsx(r,{color:"text.secondary",sx:{py:4,textAlign:"center"},children:"Brak zapisanych aktywności. Zaloguj się i wykonaj akcje – pojawią się tutaj."}):U?e.jsxs(e.Fragment,{children:[e.jsx(M,{sx:{p:0},children:_.map((s,i)=>e.jsxs(F.Fragment,{children:[i>0&&e.jsx(G,{}),e.jsxs(q,{sx:{py:2,alignItems:"flex-start","&:hover":{bgcolor:l("#1976d2",.04)}},secondaryAction:s.link?e.jsx(R,{edge:"end",onClick:()=>I(s.link),sx:{bgcolor:l("#1976d2",.1),"&:hover":{bgcolor:l("#1976d2",.2)}},children:e.jsx(P,{sx:{color:"#1976d2"}})}):null,children:[e.jsx(X,{children:e.jsx(p,{sx:{width:44,height:44,bgcolor:N(s.type),color:"white"},children:b(s.type)})}),e.jsx(J,{primary:e.jsx(r,{variant:"body1",fontWeight:600,children:s.title}),secondary:e.jsxs(o,{sx:{mt:.5},children:[e.jsxs(r,{variant:"body2",color:"text.primary",children:[s.userName," (",s.userEmail,")"]}),e.jsx(r,{variant:"caption",color:"text.secondary",children:y(new Date(s.date),"dd MMM yyyy, HH:mm:ss",{locale:C})})]})})]})]},s.id))}),e.jsx(S,{component:"div",count:a.length,page:x,onPageChange:(s,i)=>T(i),rowsPerPage:d,onRowsPerPageChange:s=>{u(parseInt(s.target.value,10)),T(0)},rowsPerPageOptions:[25,50,100,200],labelRowsPerPage:"Na stronę:"})]}):e.jsxs(e.Fragment,{children:[e.jsx(ee,{sx:{maxHeight:"70vh"},children:e.jsxs(se,{stickyHeader:!0,size:"small",children:[e.jsx(ae,{children:e.jsxs(w,{children:[e.jsx(t,{sx:{fontWeight:700,bgcolor:"background.paper"},children:"Data i godzina"}),e.jsx(t,{sx:{fontWeight:700,bgcolor:"background.paper"},children:"Kto"}),e.jsx(t,{sx:{fontWeight:700,bgcolor:"background.paper"},children:"Akcja (co zostało dodane / zmienione)"}),e.jsx(t,{sx:{fontWeight:700,bgcolor:"background.paper"},children:"Jednostka"}),e.jsx(t,{align:"right",sx:{fontWeight:700,bgcolor:"background.paper"},children:"Odnośnik"})]})}),e.jsx(re,{children:_.map(s=>e.jsxs(w,{hover:!0,sx:{"&:hover":{bgcolor:l("#1976d2",.04)}},children:[e.jsx(t,{children:e.jsx(r,{variant:"body2",children:y(new Date(s.date),"dd.MM.yyyy HH:mm:ss",{locale:C})})}),e.jsx(t,{children:e.jsxs(o,{sx:{display:"flex",alignItems:"center",gap:1.5},children:[e.jsx(p,{sx:{width:32,height:32,bgcolor:N(s.type),color:"white",fontSize:"0.875rem"},children:b(s.type)}),e.jsxs(o,{children:[e.jsx(r,{variant:"body2",fontWeight:600,children:s.userName}),e.jsx(r,{variant:"caption",color:"text.secondary",children:s.userEmail})]})]})}),e.jsx(t,{children:e.jsx(r,{variant:"body2",fontWeight:600,children:s.title})}),e.jsx(t,{children:e.jsxs(r,{variant:"caption",color:"text.secondary",children:[s.entity,s.entityId?` #${s.entityId.slice(-6)}`:""]})}),e.jsx(t,{align:"right",children:s.link?e.jsx(R,{size:"small",onClick:()=>I(s.link),sx:{bgcolor:l("#1976d2",.1),"&:hover":{bgcolor:l("#1976d2",.2)}},children:e.jsx(P,{sx:{color:"#1976d2",fontSize:18}})}):"—"})]},s.id))})]})}),e.jsx(S,{component:"div",count:a.length,page:x,onPageChange:(s,i)=>T(i),rowsPerPage:d,onRowsPerPageChange:s=>{u(parseInt(s.target.value,10)),T(0)},rowsPerPageOptions:[50,100,200,500,1e3],labelRowsPerPage:"Wierszy na stronę:"})]})})]})}export{Le as default};
