import{g as Je,a as Ye,r as d,b as er,d as rr,j as e,s as re,e as tr,f as W,h as sr,m as te,i as U,k as ze,l as ke,c as se,n as ar,o as or,p as ir,q as X,B as n,C as xe,T as o,I as J,t as i,P as S,L as D,v as w,A as L,w as z,x as pe,R as H,D as me}from"./index-DuGlS2hS.js";import{u as nr}from"./useNotification-DEJT79vM.js";import{f as Y,a as lr,b as dr}from"./dateFormat-D5f9IIy8.js";import{V as M}from"./visitStatus-kedmqlXd.js";import{r as cr,t as xr,a as pr,f as he,l as ue}from"./index-Cm20y22q.js";import{P as $e,L as F,A as k}from"./PersonAdd-Bmz4S436.js";import{E as mr}from"./EventNote-DQCOQi1j.js";import{C as fe}from"./CalendarToday-0rSQMvcI.js";import{T as hr,N as ee}from"./Notifications-xvnp-x2s.js";import{R as ur}from"./Refresh-CYwZfv-e.js";import{B as E}from"./Button-DYA-l7Ix.js";import{A as be}from"./Add-CyAZE82m.js";import{A as Le}from"./Alert-BnPrPNDn.js";import{T as ge}from"./TextField-VtT5fMIl.js";import{I as fr}from"./InputAdornment-BplF7Ie4.js";import{S as br}from"./Search-CdCexvfx.js";import{G as f}from"./Grid-9JmJah-6.js";import{C as gr}from"./Card-BZPW2CFi.js";import{C as yr}from"./CardContent-DyGdFslf.js";import{C as ye}from"./Chip-CKQ1KLG2.js";import{E as jr}from"./EventAvailable-DFN5wNgB.js";import{D as vr,a as Cr,b as wr,c as zr}from"./DialogTitle-Cnb6c1S1.js";import"./Select-DgRGz9X7.js";import"./useThemeProps-CESs6Os5.js";function kr(a){return Je("MuiLinearProgress",a)}Ye("MuiLinearProgress",["root","colorPrimary","colorSecondary","determinate","indeterminate","buffer","query","dashed","dashedColorPrimary","dashedColorSecondary","bar","bar1","bar2","barColorPrimary","barColorSecondary","bar1Indeterminate","bar1Determinate","bar1Buffer","bar2Indeterminate","bar2Buffer"]);const je=4,ve=ke`
  0% {
    left: -35%;
    right: 100%;
  }

  60% {
    left: 100%;
    right: -90%;
  }

  100% {
    left: 100%;
    right: -90%;
  }
`,Wr=typeof ve!="string"?ze`
        animation: ${ve} 2.1s cubic-bezier(0.65, 0.815, 0.735, 0.395) infinite;
      `:null,Ce=ke`
  0% {
    left: -200%;
    right: 100%;
  }

  60% {
    left: 107%;
    right: -8%;
  }

  100% {
    left: 107%;
    right: -8%;
  }
`,Sr=typeof Ce!="string"?ze`
        animation: ${Ce} 2.1s cubic-bezier(0.165, 0.84, 0.44, 1) 1.15s infinite;
      `:null,we=ke`
  0% {
    opacity: 1;
    background-position: 0 -23px;
  }

  60% {
    opacity: 0;
    background-position: 0 -23px;
  }

  100% {
    opacity: 1;
    background-position: -200px -23px;
  }
`,Rr=typeof we!="string"?ze`
        animation: ${we} 3s infinite linear;
      `:null,Nr=a=>{const{classes:t,variant:s,color:p}=a,B={root:["root",`color${W(p)}`,s],dashed:["dashed",`dashedColor${W(p)}`],bar1:["bar","bar1",`barColor${W(p)}`,(s==="indeterminate"||s==="query")&&"bar1Indeterminate",s==="determinate"&&"bar1Determinate",s==="buffer"&&"bar1Buffer"],bar2:["bar","bar2",s!=="buffer"&&`barColor${W(p)}`,s==="buffer"&&`color${W(p)}`,(s==="indeterminate"||s==="query")&&"bar2Indeterminate",s==="buffer"&&"bar2Buffer"]};return sr(B,kr,t)},We=(a,t)=>a.vars?a.vars.palette.LinearProgress[`${t}Bg`]:a.palette.mode==="light"?a.lighten(a.palette[t].main,.62):a.darken(a.palette[t].main,.5),Ir=re("span",{name:"MuiLinearProgress",slot:"Root",overridesResolver:(a,t)=>{const{ownerState:s}=a;return[t.root,t[`color${W(s.color)}`],t[s.variant]]}})(te(({theme:a})=>({position:"relative",overflow:"hidden",display:"block",height:4,zIndex:0,"@media print":{colorAdjust:"exact"},variants:[...Object.entries(a.palette).filter(U()).map(([t])=>({props:{color:t},style:{backgroundColor:We(a,t)}})),{props:({ownerState:t})=>t.color==="inherit"&&t.variant!=="buffer",style:{"&::before":{content:'""',position:"absolute",left:0,top:0,right:0,bottom:0,backgroundColor:"currentColor",opacity:.3}}},{props:{variant:"buffer"},style:{backgroundColor:"transparent"}},{props:{variant:"query"},style:{transform:"rotate(180deg)"}}]}))),Pr=re("span",{name:"MuiLinearProgress",slot:"Dashed",overridesResolver:(a,t)=>{const{ownerState:s}=a;return[t.dashed,t[`dashedColor${W(s.color)}`]]}})(te(({theme:a})=>({position:"absolute",marginTop:0,height:"100%",width:"100%",backgroundSize:"10px 10px",backgroundPosition:"0 -23px",variants:[{props:{color:"inherit"},style:{opacity:.3,backgroundImage:"radial-gradient(currentColor 0%, currentColor 16%, transparent 42%)"}},...Object.entries(a.palette).filter(U()).map(([t])=>{const s=We(a,t);return{props:{color:t},style:{backgroundImage:`radial-gradient(${s} 0%, ${s} 16%, transparent 42%)`}}})]})),Rr||{animation:`${we} 3s infinite linear`}),Dr=re("span",{name:"MuiLinearProgress",slot:"Bar1",overridesResolver:(a,t)=>{const{ownerState:s}=a;return[t.bar,t.bar1,t[`barColor${W(s.color)}`],(s.variant==="indeterminate"||s.variant==="query")&&t.bar1Indeterminate,s.variant==="determinate"&&t.bar1Determinate,s.variant==="buffer"&&t.bar1Buffer]}})(te(({theme:a})=>({width:"100%",position:"absolute",left:0,bottom:0,top:0,transition:"transform 0.2s linear",transformOrigin:"left",variants:[{props:{color:"inherit"},style:{backgroundColor:"currentColor"}},...Object.entries(a.palette).filter(U()).map(([t])=>({props:{color:t},style:{backgroundColor:(a.vars||a).palette[t].main}})),{props:{variant:"determinate"},style:{transition:`transform .${je}s linear`}},{props:{variant:"buffer"},style:{zIndex:1,transition:`transform .${je}s linear`}},{props:({ownerState:t})=>t.variant==="indeterminate"||t.variant==="query",style:{width:"auto"}},{props:({ownerState:t})=>t.variant==="indeterminate"||t.variant==="query",style:Wr||{animation:`${ve} 2.1s cubic-bezier(0.65, 0.815, 0.735, 0.395) infinite`}}]}))),Tr=re("span",{name:"MuiLinearProgress",slot:"Bar2",overridesResolver:(a,t)=>{const{ownerState:s}=a;return[t.bar,t.bar2,t[`barColor${W(s.color)}`],(s.variant==="indeterminate"||s.variant==="query")&&t.bar2Indeterminate,s.variant==="buffer"&&t.bar2Buffer]}})(te(({theme:a})=>({width:"100%",position:"absolute",left:0,bottom:0,top:0,transition:"transform 0.2s linear",transformOrigin:"left",variants:[...Object.entries(a.palette).filter(U()).map(([t])=>({props:{color:t},style:{"--LinearProgressBar2-barColor":(a.vars||a).palette[t].main}})),{props:({ownerState:t})=>t.variant!=="buffer"&&t.color!=="inherit",style:{backgroundColor:"var(--LinearProgressBar2-barColor, currentColor)"}},{props:({ownerState:t})=>t.variant!=="buffer"&&t.color==="inherit",style:{backgroundColor:"currentColor"}},{props:{color:"inherit"},style:{opacity:.3}},...Object.entries(a.palette).filter(U()).map(([t])=>({props:{color:t,variant:"buffer"},style:{backgroundColor:We(a,t),transition:`transform .${je}s linear`}})),{props:({ownerState:t})=>t.variant==="indeterminate"||t.variant==="query",style:{width:"auto"}},{props:({ownerState:t})=>t.variant==="indeterminate"||t.variant==="query",style:Sr||{animation:`${Ce} 2.1s cubic-bezier(0.165, 0.84, 0.44, 1) 1.15s infinite`}}]}))),Ar=d.forwardRef(function(t,s){const p=er({props:t,name:"MuiLinearProgress"}),{className:B,color:ae="primary",value:T,valueBuffer:V,variant:j="indeterminate",...G}=p,y={...p,color:ae,variant:j},b=Nr(y),O=rr(),R={},v={bar1:{},bar2:{}};if((j==="determinate"||j==="buffer")&&T!==void 0){R["aria-valuenow"]=Math.round(T),R["aria-valuemin"]=0,R["aria-valuemax"]=100;let C=T-100;O&&(C=-C),v.bar1.transform=`translateX(${C}%)`}if(j==="buffer"&&V!==void 0){let C=(V||0)-100;O&&(C=-C),v.bar2.transform=`translateX(${C}%)`}return e.jsxs(Ir,{className:tr(b.root,B),ownerState:y,role:"progressbar",...R,ref:s,...G,children:[j==="buffer"?e.jsx(Pr,{className:b.dashed,ownerState:y}):null,e.jsx(Dr,{className:b.bar1,ownerState:y,style:v.bar1}),j==="determinate"?null:e.jsx(Tr,{className:b.bar2,ownerState:y,style:v.bar2})]})}),Me=se(e.jsx("path",{d:"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2M9 17H7v-7h2zm4 0h-2V7h2zm4 0h-2v-4h2z"})),$r=se([e.jsx("path",{d:"M11.99 2C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2M12 20c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8"},"0"),e.jsx("path",{d:"M12.5 7H11v6l5.25 3.15.75-1.23-4.5-2.67z"},"1")]),Lr=se(e.jsx("path",{d:"M19 3h-1V1h-2v2H8V1H6v2H5c-1.11 0-1.99.9-1.99 2L3 19c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2m0 16H5V8h14zM7 10h5v5H7z"})),Fe=se(e.jsx("path",{d:"M1 21h22L12 2zm12-3h-2v-2h2zm0-4h-2v-4h2z"}));function Mr(a,t){cr(2,arguments);var s=xr(a),p=pr(t);return isNaN(p)?new Date(NaN):(p&&s.setDate(s.getDate()+p),s)}function ct(){const a=ar(),t=or(a.breakpoints.down("sm")),s=ir(),{error:p,success:B}=nr(),[ae,T]=d.useState(!0),[V,j]=d.useState(!1),[G,y]=d.useState(null),[b,O]=d.useState(""),[R,v]=d.useState([]),[C,Se]=d.useState(!1),[Fr,Re]=d.useState(!1),K=d.useRef(!1),[m,Ee]=d.useState({patientsCount:0,consultationsCount:0,emailsSentCount:0,patientsThisWeek:0,consultationsThisWeek:0,patientsWithoutConsultation:0}),[oe,Be]=d.useState([]),[ie,Ve]=d.useState([]),[ne,Oe]=d.useState([]),[N,qe]=d.useState([]),[I,Ze]=d.useState([]),[Er,He]=d.useState({plannedRevenue:0,completedRevenue:0,totalExpectedRevenue:0,visitsThisWeek:{zaplanowana:0,odbyta:0,nieobecnosc:0,anulowana:0}}),[h,A]=d.useState({open:!1,visitId:null,visitData:"",rodzajZabiegu:"",patientName:"",patientEmail:"",customMessage:"",recipientEmail:""}),[Q,Ne]=d.useState(!1),Ue=async()=>{var r,c;if(h.visitId){if(!h.recipientEmail){p("Podaj adres email odbiorcy");return}try{Ne(!0),await X.post(`/visits/${h.visitId}/reminder`,{recipientEmail:h.recipientEmail,customMessage:h.customMessage||void 0}),B("Przypomnienie wysłane pomyślnie!"),A({open:!1,visitId:null,visitData:"",rodzajZabiegu:"",patientName:"",patientEmail:"",customMessage:"",recipientEmail:""}),_(!0)}catch(x){p(((c=(r=x.response)==null?void 0:r.data)==null?void 0:c.error)||"Błąd wysyłania przypomnienia")}finally{Ne(!1)}}},le=async r=>{var x;let c="";try{c=((x=(await X.get(`/patients/${r.patient.id}`)).data.patient)==null?void 0:x.email)||""}catch(u){console.error("Błąd pobierania email pacjenta:",u)}A({open:!0,visitId:r.id,visitData:r.data,rodzajZabiegu:r.rodzajZabiegu,patientName:`${r.patient.firstName} ${r.patient.lastName}`,patientEmail:c,customMessage:"",recipientEmail:c})},_=d.useCallback(async(r=!1)=>{var c,x,u,P,q,Z,Pe,De,Te,Ae;if(!(K.current&&!r))try{K.current=!0,Re(!0),r?j(!0):T(!0),y(null);const g=(await X.get("/dashboard")).data,$=g.upcomingVisits||[];Oe($),He(g.weeklyRevenue||{plannedRevenue:0,completedRevenue:0,totalExpectedRevenue:0,visitsThisWeek:{zaplanowana:0,odbyta:0,nieobecnosc:0,anulowana:0}});const Ke=Y(new Date),Qe=Y(Mr(new Date,1)),_e=$.filter(ce=>Y(ce.data)===Ke),Xe=$.filter(ce=>Y(ce.data)===Qe);qe(_e),Ze(Xe),Ee(g.stats||{patientsCount:0,consultationsCount:0,emailsSentCount:0,patientsThisWeek:0,consultationsThisWeek:0,patientsWithoutConsultation:0}),Be(g.patientsNeedingAttention||[]),Ve(g.inactivePatients||[])}catch(l){if(((c=l==null?void 0:l.response)==null?void 0:c.status)===429){const g=((u=(x=l==null?void 0:l.response)==null?void 0:x.headers)==null?void 0:u["retry-after"])||60,$=`Zbyt wiele żądań. Spróbuj ponownie za ${g} sekund.`;y($),p($),setTimeout(()=>{K.current||_(!0)},g*1e3)}else{const g=((q=(P=l==null?void 0:l.response)==null?void 0:P.data)==null?void 0:q.message)||((Pe=(Z=l==null?void 0:l.response)==null?void 0:Z.data)==null?void 0:Pe.error)||(l==null?void 0:l.message)||"Nie udało się załadować danych dashboardu";y(g),p(g),console.error("Failed to fetch dashboard data:",{status:(De=l==null?void 0:l.response)==null?void 0:De.status,statusText:(Te=l==null?void 0:l.response)==null?void 0:Te.statusText,data:(Ae=l==null?void 0:l.response)==null?void 0:Ae.data,message:l==null?void 0:l.message})}}finally{T(!1),j(!1),Re(!1),K.current=!1}},[p]);d.useEffect(()=>{_()},[]),d.useEffect(()=>{if(b.length<2){v([]);return}const r=setTimeout(async()=>{Se(!0);try{const u=((await X.get("/patients")).data.patients||[]).filter(P=>{var q,Z;return`${P.firstName} ${P.lastName}`.toLowerCase().includes(b.toLowerCase())||((q=P.email)==null?void 0:q.toLowerCase().includes(b.toLowerCase()))||((Z=P.phone)==null?void 0:Z.includes(b))}).slice(0,5);v(u)}catch(c){console.error("Search failed",c),v([])}finally{Se(!1)}},300);return()=>clearTimeout(r)},[b]);const de=r=>lr(r),Ie=r=>dr(r);if(ae)return e.jsx(n,{sx:{display:"flex",justifyContent:"center",alignItems:"center",minHeight:"60vh"},children:e.jsx(xe,{size:60,thickness:4})});const Ge=[{title:"Pacjentów",value:m.patientsCount,subtitle:`+${m.patientsThisWeek} w tym tygodniu`,icon:$e,color:"#1976d2",progress:m.patientsThisWeek>0&&m.patientsCount>0?m.patientsThisWeek/m.patientsCount*100:0,link:"/patients"},{title:"Konsultacji",value:m.consultationsCount,subtitle:`+${m.consultationsThisWeek} w tym tygodniu`,icon:mr,color:"#1976d2",progress:m.consultationsThisWeek>0&&m.consultationsCount>0?m.consultationsThisWeek/m.consultationsCount*100:0,link:"/consultations"},{title:"Wizyt dzisiaj",value:N.length,subtitle:`${I.length} jutro`,icon:fe,color:"#1976d2",progress:0,link:"#visits"},{title:"Bez konsultacji",value:m.patientsWithoutConsultation,subtitle:"Wymaga uwagi",icon:Fe,color:"#d32f2f",progress:m.patientsWithoutConsultation>0&&m.patientsCount>0?m.patientsWithoutConsultation/m.patientsCount*100:0,link:"#attention"}];return e.jsxs(n,{sx:{pb:4},children:[e.jsxs(n,{sx:{mb:{xs:3,sm:4},px:{xs:1,sm:0},display:"flex",justifyContent:"space-between",alignItems:"flex-start",flexWrap:"wrap",gap:2},children:[e.jsxs(n,{children:[e.jsx(o,{variant:"h4",sx:{fontWeight:600,fontSize:{xs:"1.75rem",sm:"2rem"},color:"text.primary",mb:1},children:"Panel Główny"}),e.jsx(o,{variant:"body1",color:"text.secondary",sx:{fontSize:{xs:"0.875rem",sm:"1rem"}},children:he(new Date,"EEEE, d MMMM yyyy",{locale:ue})})]}),e.jsxs(n,{sx:{display:"flex",gap:1,flexWrap:"wrap"},children:[e.jsx(hr,{title:"Odśwież dane",children:e.jsx(J,{onClick:()=>_(!0),disabled:V,sx:{bgcolor:i("#1976d2",.08),"&:hover":{bgcolor:i("#1976d2",.12)}},children:e.jsx(ur,{sx:{color:"#1976d2",animation:V?"spin 1s linear infinite":"none","@keyframes spin":{"0%":{transform:"rotate(0deg)"},"100%":{transform:"rotate(360deg)"}}}})})}),e.jsx(E,{variant:"contained",startIcon:e.jsx(be,{}),onClick:()=>s("/patients/new"),sx:{bgcolor:"#1976d2",color:"white",textTransform:"none",fontWeight:500,borderRadius:2,boxShadow:"none","&:hover":{bgcolor:"#1565c0",boxShadow:"none"}},children:t?"Dodaj":"Dodaj pacjenta"})]})]}),G&&e.jsx(Le,{severity:"error",sx:{mb:3,mx:{xs:1,sm:0}},onClose:()=>y(null),children:G}),e.jsxs(S,{sx:{p:{xs:1.5,sm:2},mb:4,mx:{xs:1,sm:0},background:"white",borderRadius:3,border:"1px solid",borderColor:"divider",boxShadow:"0 4px 12px rgba(0,0,0,0.05)"},children:[e.jsx(ge,{fullWidth:!0,placeholder:"Szybkie wyszukiwanie pacjenta...",value:b,onChange:r=>O(r.target.value),size:t?"small":"medium",InputProps:{startAdornment:e.jsx(fr,{position:"start",children:C?e.jsx(xe,{size:20}):e.jsx(br,{sx:{color:"text.secondary"}})})},sx:{"& .MuiOutlinedInput-root":{borderRadius:3}}}),R.length>0&&e.jsx(D,{sx:{mt:2,p:0},children:R.map(r=>e.jsxs(w,{onClick:()=>{s(`/patients/${r.id}`),O(""),v([])},sx:{borderRadius:3,mb:1,"&:hover":{bgcolor:i("#1976d2",.05)}},children:[e.jsx(F,{children:e.jsxs(L,{sx:{bgcolor:i("#1976d2",.1),color:"#1976d2",fontWeight:600},children:[r.firstName[0],r.lastName[0]]})}),e.jsx(z,{primary:`${r.firstName} ${r.lastName}`,primaryTypographyProps:{fontWeight:600},secondary:r.email||r.phone}),e.jsx(k,{sx:{color:"text.secondary",opacity:.5}})]},r.id))})]}),e.jsx(f,{container:!0,spacing:3,sx:{mb:4,px:{xs:1,sm:0}},children:Ge.map((r,c)=>e.jsx(f,{size:{xs:12,sm:6,md:3},children:e.jsx(gr,{onClick:()=>r.link.startsWith("#")?null:s(r.link),sx:{position:"relative",overflow:"hidden",borderRadius:3,border:"1px solid",borderColor:"divider",boxShadow:"0 4px 20px rgba(0,0,0,0.05)",background:"white",height:"100%",cursor:r.link.startsWith("#")?"default":"pointer",transition:"all 0.2s","&:hover":r.link.startsWith("#")?{}:{transform:"translateY(-4px)",boxShadow:"0 8px 24px rgba(0,0,0,0.1)"},"&::before":{content:'""',position:"absolute",top:0,left:0,right:0,height:"3px",background:r.color,borderRadius:"16px 16px 0 0"}},children:e.jsxs(yr,{sx:{p:3,overflow:"hidden"},children:[e.jsx(n,{sx:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",mb:2},children:e.jsx(n,{sx:{width:48,height:48,borderRadius:"8px",background:i(r.color,.1),display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(r.icon,{sx:{color:r.color,fontSize:24}})})}),e.jsx(o,{variant:"h3",sx:{fontWeight:600,mb:.5,fontSize:{xs:"2rem",sm:"2.5rem"},color:"text.primary"},children:r.value}),e.jsx(o,{variant:"body2",color:"text.secondary",sx:{fontWeight:600,mb:1},children:r.title}),e.jsx(o,{variant:"caption",color:"text.secondary",sx:{fontWeight:500,mb:r.progress>0?2:0,display:"block"},children:r.subtitle}),r.progress>0&&e.jsx(n,{sx:{mt:2,width:"100%",overflow:"hidden",borderRadius:1},children:e.jsx(Ar,{variant:"determinate",value:Math.min(r.progress,100),sx:{height:8,borderRadius:4,bgcolor:i(r.color,.1),"& .MuiLinearProgress-bar":{background:r.color,borderRadius:4}}})})]})})},c))}),e.jsx(f,{container:!0,spacing:3,sx:{mb:4,px:{xs:1,sm:0}},children:e.jsx(f,{size:{xs:12,md:4},children:e.jsxs(S,{sx:{p:{xs:2.5,sm:3},height:"100%",borderRadius:3,background:"white",border:"1px solid",borderColor:"divider",boxShadow:"0 2px 8px rgba(0,0,0,0.08)"},children:[e.jsx(o,{variant:"h6",sx:{fontWeight:600,mb:2,color:"text.primary"},children:"Szybkie akcje"}),e.jsxs(D,{sx:{p:0},children:[e.jsxs(w,{onClick:()=>s("/patients/new"),sx:{mb:1,borderRadius:2,border:"1px solid",borderColor:"divider",transition:"all 0.2s","&:hover":{bgcolor:i("#1976d2",.05),borderColor:"#1976d2"}},children:[e.jsx(pe,{children:e.jsx($e,{sx:{color:"#1976d2"}})}),e.jsx(z,{primary:"Dodaj pacjenta",primaryTypographyProps:{fontWeight:500,color:"text.primary"}}),e.jsx(k,{sx:{color:"text.secondary",opacity:.5}})]}),e.jsxs(w,{onClick:()=>s("/visits/new"),sx:{mb:1,borderRadius:2,border:"1px solid",borderColor:"divider",transition:"all 0.2s","&:hover":{bgcolor:i("#1976d2",.05),borderColor:"#1976d2"}},children:[e.jsx(pe,{children:e.jsx(fe,{sx:{color:"#1976d2"}})}),e.jsx(z,{primary:"Nowa wizyta",primaryTypographyProps:{fontWeight:500,color:"text.primary"}}),e.jsx(k,{sx:{color:"text.secondary",opacity:.5}})]}),e.jsxs(w,{onClick:()=>s("/patients"),sx:{borderRadius:2,border:"1px solid",borderColor:"divider",transition:"all 0.2s","&:hover":{bgcolor:i("#1976d2",.05),borderColor:"#1976d2"}},children:[e.jsx(pe,{children:e.jsx(Me,{sx:{color:"#1976d2"}})}),e.jsx(z,{primary:"Lista pacjentów",primaryTypographyProps:{fontWeight:500,color:"text.primary"}}),e.jsx(k,{sx:{color:"text.secondary",opacity:.5}})]})]})]})})}),e.jsxs(n,{id:"visits",sx:{mb:4,px:{xs:1,sm:0}},children:[e.jsxs(n,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2},children:[e.jsx(o,{variant:"h5",sx:{fontWeight:700},children:"Nadchodzące wizyty"}),e.jsx(E,{variant:"outlined",startIcon:e.jsx(be,{}),onClick:()=>s("/patients"),size:"small",sx:{textTransform:"none",fontWeight:600,borderRadius:2},children:"Dodaj wizytę"})]}),e.jsxs(f,{container:!0,spacing:3,children:[N.length>0&&e.jsx(f,{size:{xs:12,md:6},children:e.jsxs(S,{sx:{p:{xs:2,sm:3},background:"white",borderRadius:3,border:"2px solid",borderColor:"#1976d2",boxShadow:`0 8px 24px ${i("#1976d2",.15)}`},children:[e.jsxs(n,{sx:{display:"flex",alignItems:"center",gap:1.5,mb:2},children:[e.jsx(Lr,{sx:{color:"#1976d2",fontSize:28}}),e.jsxs(n,{children:[e.jsx(o,{variant:"h6",sx:{fontWeight:700,color:"#1976d2"},children:"Dzisiaj"}),e.jsxs(o,{variant:"caption",color:"text.secondary",children:[N.length," ",N.length===1?"wizyta":"wizyt"]})]})]}),e.jsx(D,{sx:{p:0},children:N.map((r,c)=>{const x=M[r.status]||M.ZAPLANOWANA;return e.jsxs(H.Fragment,{children:[c>0&&e.jsx(me,{sx:{my:1}}),e.jsxs(w,{onClick:()=>s(`/patients/${r.patient.id}`),sx:{borderRadius:2,"&:hover":{bgcolor:i("#1976d2",.05)}},children:[e.jsx(F,{children:e.jsxs(L,{sx:{bgcolor:i("#1976d2",.1),color:"#1976d2",fontWeight:600},children:[r.patient.firstName[0],r.patient.lastName[0]]})}),e.jsx(z,{primary:e.jsxs(n,{sx:{display:"flex",alignItems:"center",gap:1,flexWrap:"wrap"},children:[e.jsxs(o,{variant:"body1",sx:{fontWeight:600},children:[r.patient.firstName," ",r.patient.lastName]}),e.jsx(ye,{label:x.label,size:"small",sx:{bgcolor:x.bgColor,color:x.color,fontWeight:600,fontSize:"0.7rem",height:20}})]}),secondary:e.jsxs(n,{sx:{display:"flex",alignItems:"center",gap:1,flexWrap:"wrap",mt:.5},children:[e.jsx(o,{variant:"body2",color:"text.secondary",children:r.rodzajZabiegu}),e.jsx(o,{variant:"caption",sx:{color:"#1976d2",fontWeight:600},children:de(r.data)}),r.cena&&e.jsxs(o,{variant:"caption",sx:{bgcolor:i("#34C759",.1),color:"#34C759",px:1,borderRadius:1,fontWeight:600},children:[Number(r.cena).toFixed(0)," zł"]})]})}),e.jsxs(n,{sx:{display:"flex",alignItems:"center",gap:.5},children:[e.jsx(J,{size:"small",onClick:u=>{u.stopPropagation(),le(r)},sx:{color:"#FF9500","&:hover":{bgcolor:i("#FF9500",.1)}},children:e.jsx(ee,{fontSize:"small"})}),e.jsx(k,{sx:{color:"#1976d2",opacity:.5}})]})]})]},r.id)})})]})}),I.length>0&&e.jsx(f,{size:{xs:12,md:6},children:e.jsxs(S,{sx:{p:{xs:2,sm:3},background:"white",borderRadius:3,border:"1px solid",borderColor:i("#1976d2",.3),boxShadow:`0 8px 24px ${i("#1976d2",.1)}`},children:[e.jsxs(n,{sx:{display:"flex",alignItems:"center",gap:1.5,mb:2},children:[e.jsx($r,{sx:{color:"#1976d2",fontSize:28}}),e.jsxs(n,{children:[e.jsx(o,{variant:"h6",sx:{fontWeight:700,color:"#1976d2"},children:"Jutro"}),e.jsxs(o,{variant:"caption",color:"text.secondary",children:[I.length," ",I.length===1?"wizyta":"wizyt"]})]})]}),e.jsx(D,{sx:{p:0},children:I.map((r,c)=>{const x=M[r.status]||M.ZAPLANOWANA;return e.jsxs(H.Fragment,{children:[c>0&&e.jsx(me,{sx:{my:1}}),e.jsxs(w,{onClick:()=>s(`/patients/${r.patient.id}`),sx:{borderRadius:2,"&:hover":{bgcolor:i("#1976d2",.05)}},children:[e.jsx(F,{children:e.jsxs(L,{sx:{bgcolor:i("#1976d2",.1),color:"#1976d2",fontWeight:600},children:[r.patient.firstName[0],r.patient.lastName[0]]})}),e.jsx(z,{primary:e.jsxs(n,{sx:{display:"flex",alignItems:"center",gap:1,flexWrap:"wrap"},children:[e.jsxs(o,{variant:"body1",sx:{fontWeight:600},children:[r.patient.firstName," ",r.patient.lastName]}),e.jsx(ye,{label:x.label,size:"small",sx:{bgcolor:x.bgColor,color:x.color,fontWeight:600,fontSize:"0.7rem",height:20}})]}),secondary:e.jsxs(n,{sx:{display:"flex",alignItems:"center",gap:1,flexWrap:"wrap",mt:.5},children:[e.jsx(o,{variant:"body2",color:"text.secondary",children:r.rodzajZabiegu}),e.jsxs(o,{variant:"caption",sx:{color:"#1976d2",fontWeight:600},children:[Ie(r.data),", ",de(r.data)]}),r.cena&&e.jsxs(o,{variant:"caption",sx:{bgcolor:i("#34C759",.1),color:"#34C759",px:1,borderRadius:1,fontWeight:600},children:[Number(r.cena).toFixed(0)," zł"]})]})}),e.jsxs(n,{sx:{display:"flex",alignItems:"center",gap:.5},children:[e.jsx(J,{size:"small",onClick:u=>{u.stopPropagation(),le(r)},sx:{color:"#FF9500","&:hover":{bgcolor:i("#FF9500",.1)}},children:e.jsx(ee,{fontSize:"small"})}),e.jsx(k,{sx:{color:"#1976d2",opacity:.5}})]})]})]},r.id)})})]})}),N.length===0&&I.length===0&&ne.length>0&&e.jsx(f,{size:{xs:12},children:e.jsxs(S,{sx:{p:{xs:2,sm:3},background:"white",borderRadius:3,border:"1px solid",borderColor:i("#1976d2",.3),boxShadow:`0 8px 24px ${i("#1976d2",.1)}`},children:[e.jsxs(n,{sx:{display:"flex",alignItems:"center",gap:2,mb:3},children:[e.jsx(jr,{sx:{color:"#1976d2",fontSize:{xs:24,sm:32}}}),e.jsxs(n,{children:[e.jsx(o,{variant:"h6",sx:{fontWeight:700,color:"#1976d2",fontSize:{xs:"1rem",sm:"1.25rem"}},children:"Nadchodzące wizyty i zabiegi"}),e.jsx(o,{variant:"body2",color:"text.secondary",children:"Najbliższe zaplanowane wizyty"})]})]}),e.jsx(D,{sx:{p:0},children:ne.slice(0,6).map((r,c)=>{const x=M[r.status]||M.ZAPLANOWANA;return e.jsxs(H.Fragment,{children:[c>0&&e.jsx(me,{sx:{my:1}}),e.jsxs(w,{onClick:()=>s(`/patients/${r.patient.id}`),sx:{borderRadius:2,"&:hover":{bgcolor:i("#1976d2",.05)}},children:[e.jsx(F,{children:e.jsxs(L,{sx:{bgcolor:i("#1976d2",.1),color:"#1976d2",fontWeight:600},children:[r.patient.firstName[0],r.patient.lastName[0]]})}),e.jsx(z,{primary:e.jsxs(n,{sx:{display:"flex",alignItems:"center",gap:1,flexWrap:"wrap"},children:[e.jsxs(o,{variant:"body1",sx:{fontWeight:600},children:[r.patient.firstName," ",r.patient.lastName]}),e.jsx(ye,{label:x.label,size:"small",sx:{bgcolor:x.bgColor,color:x.color,fontWeight:600,fontSize:"0.7rem",height:20}})]}),secondary:e.jsxs(n,{sx:{display:"flex",alignItems:"center",gap:1,flexWrap:"wrap",mt:.5},children:[e.jsx(o,{variant:"body2",color:"text.secondary",children:r.rodzajZabiegu}),e.jsxs(o,{variant:"caption",sx:{color:"#1976d2",fontWeight:600},children:[Ie(r.data),", ",de(r.data)]}),r.numerWSerii&&r.liczbaSerii&&e.jsxs(o,{variant:"caption",sx:{bgcolor:i("#007AFF",.1),color:"#007AFF",px:1,borderRadius:1,fontWeight:600},children:[r.numerWSerii,"/",r.liczbaSerii]}),r.cena&&e.jsxs(o,{variant:"caption",sx:{bgcolor:i("#34C759",.1),color:"#34C759",px:1,borderRadius:1,fontWeight:600},children:[Number(r.cena).toFixed(0)," zł"]})]})}),e.jsxs(n,{sx:{display:"flex",alignItems:"center",gap:.5},children:[e.jsx(J,{size:"small",onClick:u=>{u.stopPropagation(),le(r)},sx:{color:"#FF9500","&:hover":{bgcolor:i("#FF9500",.1)}},children:e.jsx(ee,{fontSize:"small"})}),e.jsx(k,{sx:{color:"#1976d2",opacity:.5}})]})]})]},r.id)})})]})}),N.length===0&&I.length===0&&ne.length===0&&e.jsx(f,{size:{xs:12},children:e.jsxs(S,{sx:{p:4,textAlign:"center",background:"white",borderRadius:3,border:"1px dashed",borderColor:i("#1976d2",.4)},children:[e.jsx(fe,{sx:{fontSize:48,color:i("#1976d2",.5),mb:1}}),e.jsx(o,{variant:"body1",color:"text.secondary",sx:{mb:2},children:"Brak nadchodzących wizyt. Użyj przycisku „Dodaj wizytę”, aby zaplanować wizytę."}),e.jsx(E,{variant:"contained",startIcon:e.jsx(be,{}),onClick:()=>s("/patients"),sx:{textTransform:"none",fontWeight:600},children:"Dodaj wizytę"})]})})]})]}),(oe.length>0||ie.length>0)&&e.jsx(n,{id:"attention",sx:{mb:4,px:{xs:1,sm:0}},children:e.jsxs(f,{container:!0,spacing:3,children:[oe.length>0&&e.jsx(f,{size:{xs:12,md:6},children:e.jsxs(S,{sx:{p:{xs:2,sm:3},background:"white",borderRadius:3,border:"1px solid",borderColor:i("#d32f2f",.3),boxShadow:`0 8px 24px ${i("#d32f2f",.1)}`},children:[e.jsxs(n,{sx:{display:"flex",alignItems:"center",gap:2,mb:3},children:[e.jsx(Fe,{sx:{color:"#d32f2f",fontSize:{xs:24,sm:32}}}),e.jsxs(n,{children:[e.jsx(o,{variant:"h6",sx:{fontWeight:700,color:"#d32f2f",fontSize:{xs:"1rem",sm:"1.25rem"}},children:"Pacjenci bez konsultacji"}),e.jsxs(o,{variant:"body2",color:"text.secondary",children:[m.patientsWithoutConsultation," pacjentów wymaga uwagi"]})]})]}),e.jsx(D,{sx:{p:0},children:oe.map(r=>e.jsx(H.Fragment,{children:e.jsxs(w,{onClick:()=>s(`/patients/${r.id}`),sx:{borderRadius:2,mb:.5,"&:hover":{bgcolor:i("#d32f2f",.05)}},children:[e.jsx(F,{children:e.jsxs(L,{sx:{bgcolor:i("#d32f2f",.1),color:"#d32f2f",fontWeight:600},children:[r.firstName[0],r.lastName[0]]})}),e.jsx(z,{primary:e.jsxs(o,{variant:"body1",sx:{fontWeight:600},children:[r.firstName," ",r.lastName]}),secondary:e.jsxs(o,{variant:"caption",color:"text.secondary",children:["Dodany: ",he(new Date(r.createdAt),"dd MMM yyyy",{locale:ue})]})}),e.jsx(k,{sx:{color:"#d32f2f",opacity:.5}})]})},r.id))}),e.jsx(E,{fullWidth:!0,variant:"outlined",onClick:()=>s("/patients"),sx:{mt:2,borderRadius:2,textTransform:"none",fontWeight:600,borderColor:"#d32f2f",color:"#d32f2f","&:hover":{borderColor:"#d32f2f",bgcolor:i("#d32f2f",.05)}},children:"Zobacz wszystkich"})]})}),ie.length>0&&e.jsx(f,{size:{xs:12,md:6},children:e.jsxs(S,{sx:{p:{xs:2,sm:3},background:"white",borderRadius:3,border:"1px solid",borderColor:i("#1976d2",.3),boxShadow:`0 8px 24px ${i("#1976d2",.1)}`},children:[e.jsxs(n,{sx:{display:"flex",alignItems:"center",gap:2,mb:3},children:[e.jsx(Me,{sx:{color:"#1976d2",fontSize:{xs:24,sm:32}}}),e.jsxs(n,{children:[e.jsx(o,{variant:"h6",sx:{fontWeight:700,color:"#1976d2",fontSize:{xs:"1rem",sm:"1.25rem"}},children:"Pacjenci nieaktywni"}),e.jsx(o,{variant:"body2",color:"text.secondary",children:"Brak konsultacji przez 30+ dni"})]})]}),e.jsx(D,{sx:{p:0},children:ie.map(r=>e.jsx(H.Fragment,{children:e.jsxs(w,{onClick:()=>s(`/patients/${r.id}`),sx:{borderRadius:2,mb:.5,"&:hover":{bgcolor:i("#1976d2",.05)}},children:[e.jsx(F,{children:e.jsxs(L,{sx:{bgcolor:i("#1976d2",.1),color:"#1976d2",fontWeight:600},children:[r.firstName[0],r.lastName[0]]})}),e.jsx(z,{primary:e.jsxs(o,{variant:"body1",sx:{fontWeight:600},children:[r.firstName," ",r.lastName]}),secondary:e.jsxs(o,{variant:"caption",color:"text.secondary",children:["Dodany: ",he(new Date(r.createdAt),"dd MMM yyyy",{locale:ue})]})}),e.jsx(k,{sx:{color:"#1976d2",opacity:.5}})]})},r.id))})]})})]})}),e.jsxs(vr,{open:h.open,onClose:()=>A({...h,open:!1}),maxWidth:"sm",fullWidth:!0,PaperProps:{sx:{borderRadius:3,p:1}},children:[e.jsx(Cr,{sx:{fontWeight:600,pb:2},children:"Wyślij przypomnienie o wizycie"}),e.jsxs(wr,{children:[e.jsxs(n,{sx:{mb:2},children:[e.jsx(o,{variant:"body2",color:"text.secondary",gutterBottom:!0,children:"Pacjent:"}),e.jsx(o,{variant:"h6",sx:{fontWeight:600,mb:1},children:h.patientName}),e.jsx(o,{variant:"body2",color:"text.secondary",gutterBottom:!0,children:"Wizyta:"}),e.jsx(o,{variant:"body1",sx:{fontWeight:500,mb:1},children:h.rodzajZabiegu}),e.jsx(o,{variant:"body2",color:"text.secondary",children:h.visitData?new Date(h.visitData).toLocaleString("pl-PL",{weekday:"long",year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}):""})]}),e.jsx(ge,{fullWidth:!0,label:"Adres email odbiorcy",type:"email",value:h.recipientEmail,onChange:r=>A({...h,recipientEmail:r.target.value}),required:!0,sx:{mb:2},helperText:h.patientEmail?"Email pacjenta":"Pacjent nie ma zapisanego adresu email"}),e.jsx(ge,{fullWidth:!0,label:"Dodatkowa wiadomość (opcjonalnie)",multiline:!0,rows:4,value:h.customMessage,onChange:r=>A({...h,customMessage:r.target.value}),placeholder:"Dodaj dodatkową wiadomość do przypomnienia...",sx:{mb:2}}),e.jsx(Le,{severity:"info",sx:{mt:2},children:"Pacjent otrzyma email z przypomnieniem oraz możliwością zapisania wizyty do kalendarza (Google Calendar, Outlook, lub plik .ics)."})]}),e.jsxs(zr,{sx:{p:2,pt:1},children:[e.jsx(E,{onClick:()=>A({...h,open:!1}),disabled:Q,children:"Anuluj"}),e.jsx(E,{onClick:Ue,variant:"contained",startIcon:Q?e.jsx(xe,{size:20}):e.jsx(ee,{}),disabled:Q||!h.recipientEmail,sx:{bgcolor:"#FF9500","&:hover":{bgcolor:"#E68900"}},children:Q?"Wysyłanie...":"Wyślij przypomnienie"})]})]})]})}export{ct as default};
