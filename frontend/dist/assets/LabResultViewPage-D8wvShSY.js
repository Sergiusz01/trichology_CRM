import{N as E,r as j,p as I,q as P,j as e,B as s,C as S,T as t,P as u}from"./index-DuGlS2hS.js";import{u as N}from"./useNotification-DEJT79vM.js";import{C}from"./Container-DggLIBHC.js";import{A as O}from"./Alert-BnPrPNDn.js";import{B as w}from"./Button-DYA-l7Ix.js";import{A as T}from"./ArrowBack-BLijn9hB.js";import{G as M}from"./GetApp-BdLPp6v8.js";import{E as Y}from"./Edit-CC4dElt7.js";import{T as y,a as R,b as v,c as p,d as i,e as W}from"./TableRow-B0Vjdlj8.js";import{C as Z}from"./Chip-CKQ1KLG2.js";import"./useThemeProps-CESs6Os5.js";const G=l=>l?new Date(l).toLocaleDateString("pl-PL",{day:"2-digit",month:"2-digit",year:"numeric"}):"-",K=l=>new Date(l).toLocaleString("pl-PL",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}),$=l=>{if(!l)return"default";switch(l){case"LOW":case"HIGH":return"error";case"NORMAL":return"success";default:return"default"}},o=(l,a,r,x,f,h)=>a==null?null:e.jsxs(p,{children:[e.jsx(i,{sx:{fontSize:{xs:"0.75rem",sm:"0.875rem"}},children:e.jsx("strong",{children:l})}),e.jsxs(i,{sx:{fontSize:{xs:"0.75rem",sm:"0.875rem"}},children:[a," ",r||""]}),e.jsxs(i,{sx:{fontSize:{xs:"0.75rem",sm:"0.875rem"},display:{xs:"none",md:"table-cell"}},children:[x??"-"," - ",f??"-"]}),e.jsx(i,{sx:{fontSize:{xs:"0.75rem",sm:"0.875rem"}},children:e.jsx(Z,{label:h||"-",color:$(h),size:"small",sx:{fontSize:{xs:"0.65rem",sm:"0.75rem"},height:{xs:20,sm:24}}})})]});function se(){const{id:l,labResultId:a}=E(),[r,x]=j.useState(null),[f,h]=j.useState(!0),[F,L]=j.useState(null),[k,D]=j.useState(!1),B=I(),{error:A,success:z}=N();j.useEffect(()=>{a?U():(L("Brak ID wyniku badania"),h(!1))},[a]);const U=async()=>{var m,b;try{h(!0),L(null);const d=await P.get(`/lab-results/${a}`);x(d.data.labResult||d.data)}catch(d){console.error("Błąd pobierania wyniku:",d);const c=((b=(m=d.response)==null?void 0:m.data)==null?void 0:b.error)||"Błąd pobierania wyniku badania";L(c),A(c)}finally{h(!1)}},H=async()=>{var m,b;try{D(!0);const d=await P.get(`/lab-results/${a}/pdf`,{responseType:"blob"}),c=window.URL.createObjectURL(new Blob([d.data])),g=document.createElement("a");g.href=c,g.setAttribute("download",`wynik-badan-${a}.pdf`),document.body.appendChild(g),g.click(),g.remove(),window.URL.revokeObjectURL(c),z("PDF pobrany pomyślnie")}catch(d){console.error("Błąd pobierania PDF:",d);const c=((b=(m=d.response)==null?void 0:m.data)==null?void 0:b.error)||"Błąd pobierania PDF";A(c)}finally{D(!1)}};if(f)return e.jsx(C,{maxWidth:"lg",children:e.jsxs(s,{sx:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",py:8,gap:2},children:[e.jsx(S,{size:48}),e.jsx(t,{variant:"body1",color:"text.secondary",children:"Ładowanie wyniku badania..."})]})});if(F||!r)return e.jsx(C,{maxWidth:"lg",children:e.jsxs(s,{sx:{py:4},children:[e.jsx(O,{severity:"error",sx:{mb:2},children:F||"Wynik badania nie znaleziony"}),e.jsx(w,{onClick:()=>B(-1),startIcon:e.jsx(T,{}),children:"Powrót"})]})});const n=r.patient||{};return e.jsxs(C,{maxWidth:"lg",sx:{py:{xs:2,sm:3},px:{xs:1,sm:2,md:3}},children:[e.jsxs(s,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:3},children:[e.jsx(w,{startIcon:e.jsx(T,{}),onClick:()=>B(-1),sx:{mb:2},children:"Powrót"}),e.jsxs(s,{sx:{display:"flex",gap:2},children:[e.jsx(w,{variant:"outlined",startIcon:k?e.jsx(S,{size:20}):e.jsx(M,{}),onClick:H,disabled:k,children:k?"Pobieranie...":"Pobierz PDF"}),e.jsx(w,{variant:"contained",startIcon:e.jsx(Y,{}),onClick:()=>B(`/patients/${l||n.id}/lab-results/${a}/edit`),children:"Edytuj"})]})]}),e.jsxs(u,{sx:{p:{xs:2,sm:3,md:4},backgroundColor:"#fff",boxShadow:2},children:[e.jsxs(s,{sx:{textAlign:"center",borderBottom:"2px solid #333",mb:3,pb:2},children:[e.jsx(t,{variant:"h4",sx:{fontWeight:"bold",mb:1},children:"WYNIK BADAŃ LABORATORYJNYCH"}),e.jsxs(t,{variant:"body1",children:["Data badania: ",e.jsx("strong",{children:G(r.date)})]})]}),e.jsxs(s,{sx:{mb:3,p:2,backgroundColor:"#f9f9f9",borderRadius:1},children:[e.jsx(t,{variant:"h6",sx:{mb:2,fontWeight:"bold"},children:"Dane pacjenta"}),e.jsxs(s,{sx:{display:"grid",gridTemplateColumns:{xs:"1fr",sm:"1fr 1fr"},gap:1},children:[e.jsxs(s,{children:[e.jsxs(t,{children:[e.jsx("strong",{children:"Pacjent:"})," ",n.firstName," ",n.lastName]}),n.age&&e.jsxs(t,{children:[e.jsx("strong",{children:"Wiek:"})," ",n.age," lat"]}),n.gender&&e.jsxs(t,{children:[e.jsx("strong",{children:"Płeć:"})," ",n.gender==="MALE"?"Mężczyzna":n.gender==="FEMALE"?"Kobieta":"Inna"]})]}),e.jsxs(s,{children:[n.phone&&e.jsxs(t,{children:[e.jsx("strong",{children:"Telefon:"})," ",n.phone]}),n.email&&e.jsxs(t,{children:[e.jsx("strong",{children:"Email:"})," ",n.email]})]})]})]}),e.jsxs(s,{sx:{mt:3},children:[r.hgb!==null&&r.hgb!==void 0||r.rbc!==null&&r.rbc!==void 0||r.wbc!==null&&r.wbc!==void 0||r.plt!==null&&r.plt!==void 0?e.jsxs(e.Fragment,{children:[e.jsx(t,{variant:"h6",sx:{fontSize:"1.25rem",fontWeight:"bold",mt:3,mb:2,color:"#2c3e50",borderBottom:"2px solid #3498db",pb:1},children:"MORFOLOGIA KRWI"}),e.jsx(y,{component:u,sx:{mb:3},children:e.jsxs(R,{children:[e.jsx(v,{children:e.jsxs(p,{sx:{backgroundColor:"#2c3e50"},children:[e.jsx(i,{sx:{color:"white",fontWeight:"bold"},children:"Parametr"}),e.jsx(i,{sx:{color:"white",fontWeight:"bold"},children:"Wartość"}),e.jsx(i,{sx:{color:"white",fontWeight:"bold"},children:"Zakres referencyjny"}),e.jsx(i,{sx:{color:"white",fontWeight:"bold"},children:"Status"})]})}),e.jsxs(W,{children:[o("Hemoglobina (HGB)",r.hgb,r.hgbUnit||"",r.hgbRefLow,r.hgbRefHigh,r.hgbFlag),o("Erytrocyty (RBC)",r.rbc,r.rbcUnit||"",r.rbcRefLow,r.rbcRefHigh,r.rbcFlag),o("Leukocyty (WBC)",r.wbc,r.wbcUnit||"",r.wbcRefLow,r.wbcRefHigh,r.wbcFlag),o("Płytki krwi (PLT)",r.plt,r.pltUnit||"",r.pltRefLow,r.pltRefHigh,r.pltFlag)]})]})})]}):null,r.ferritin!==null&&r.ferritin!==void 0||r.iron!==null&&r.iron!==void 0?e.jsxs(e.Fragment,{children:[e.jsx(t,{variant:"h6",sx:{fontSize:"1.25rem",fontWeight:"bold",mt:3,mb:2,color:"#2c3e50",borderBottom:"2px solid #3498db",pb:1},children:"ŻELAZO"}),e.jsx(y,{component:u,sx:{mb:3},children:e.jsxs(R,{children:[e.jsx(v,{children:e.jsxs(p,{sx:{backgroundColor:"#2c3e50"},children:[e.jsx(i,{sx:{color:"white",fontWeight:"bold"},children:"Parametr"}),e.jsx(i,{sx:{color:"white",fontWeight:"bold"},children:"Wartość"}),e.jsx(i,{sx:{color:"white",fontWeight:"bold"},children:"Zakres referencyjny"}),e.jsx(i,{sx:{color:"white",fontWeight:"bold"},children:"Status"})]})}),e.jsxs(W,{children:[o("Ferrytyna",r.ferritin,r.ferritinUnit||"",r.ferritinRefLow,r.ferritinRefHigh,r.ferritinFlag),o("Żelazo",r.iron,r.ironUnit||"",r.ironRefLow,r.ironRefHigh,r.ironFlag)]})]})})]}):null,r.vitaminD3!==null&&r.vitaminD3!==void 0||r.vitaminB12!==null&&r.vitaminB12!==void 0||r.folicAcid!==null&&r.folicAcid!==void 0?e.jsxs(e.Fragment,{children:[e.jsx(t,{variant:"h6",sx:{fontSize:"1.25rem",fontWeight:"bold",mt:3,mb:2,color:"#2c3e50",borderBottom:"2px solid #3498db",pb:1},children:"WITAMINY"}),e.jsx(y,{component:u,sx:{mb:3},children:e.jsxs(R,{children:[e.jsx(v,{children:e.jsxs(p,{sx:{backgroundColor:"#2c3e50"},children:[e.jsx(i,{sx:{color:"white",fontWeight:"bold"},children:"Parametr"}),e.jsx(i,{sx:{color:"white",fontWeight:"bold"},children:"Wartość"}),e.jsx(i,{sx:{color:"white",fontWeight:"bold"},children:"Zakres referencyjny"}),e.jsx(i,{sx:{color:"white",fontWeight:"bold"},children:"Status"})]})}),e.jsxs(W,{children:[o("Witamina D3",r.vitaminD3,r.vitaminD3Unit||"",r.vitaminD3RefLow,r.vitaminD3RefHigh,r.vitaminD3Flag),o("Witamina B12",r.vitaminB12,r.vitaminB12Unit||"",r.vitaminB12RefLow,r.vitaminB12RefHigh,r.vitaminB12Flag),o("Kwas foliowy",r.folicAcid,r.folicAcidUnit||"",r.folicAcidRefLow,r.folicAcidRefHigh,r.folicAcidFlag)]})]})})]}):null,r.tsh!==null&&r.tsh!==void 0||r.ft3!==null&&r.ft3!==void 0||r.ft4!==null&&r.ft4!==void 0?e.jsxs(e.Fragment,{children:[e.jsx(t,{variant:"h6",sx:{fontSize:"1.25rem",fontWeight:"bold",mt:3,mb:2,color:"#2c3e50",borderBottom:"2px solid #3498db",pb:1},children:"FUNKCJA TARCZYCY"}),e.jsx(y,{component:u,sx:{mb:3},children:e.jsxs(R,{children:[e.jsx(v,{children:e.jsxs(p,{sx:{backgroundColor:"#2c3e50"},children:[e.jsx(i,{sx:{color:"white",fontWeight:"bold"},children:"Parametr"}),e.jsx(i,{sx:{color:"white",fontWeight:"bold"},children:"Wartość"}),e.jsx(i,{sx:{color:"white",fontWeight:"bold"},children:"Zakres referencyjny"}),e.jsx(i,{sx:{color:"white",fontWeight:"bold"},children:"Status"})]})}),e.jsxs(W,{children:[o("TSH",r.tsh,r.tshUnit||"",r.tshRefLow,r.tshRefHigh,r.tshFlag),o("FT3",r.ft3,r.ft3Unit||"",r.ft3RefLow,r.ft3RefHigh,r.ft3Flag),o("FT4",r.ft4,r.ft4Unit||"",r.ft4RefLow,r.ft4RefHigh,r.ft4Flag)]})]})})]}):null]}),r.notes&&e.jsxs(s,{sx:{mt:3,p:2,backgroundColor:"#fff3cd",borderLeft:"4px solid #ffc107",borderRadius:1},children:[e.jsx(t,{variant:"h6",sx:{fontWeight:"bold",mb:1},children:"Uwagi"}),e.jsx(t,{children:r.notes})]}),e.jsx(s,{sx:{mt:4,pt:2,borderTop:"1px solid #ddd",fontSize:"0.875rem",textAlign:"right",color:"#666"},children:e.jsxs(t,{variant:"body2",children:["Wygenerowano: ",K(new Date)]})})]})]})}export{se as default};
