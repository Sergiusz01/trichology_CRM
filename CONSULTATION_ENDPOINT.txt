// Add this endpoint at line 117 in consultations.ts, before the '/patient/:patientId' route

// Get all consultations (for dashboard and reports)
router.get('/', authenticate, async (req: AuthRequest, res, next) => {
  try {
    const { limit = '100' } = req.query;
    const limitNum = parseInt(limit as string, 10);

    const consultations = await prisma.consultation.findMany({
      take: limitNum,
      orderBy: { consultationDate: 'desc' },
      include: {
        patient: {
          select: { id: true, firstName: true, lastName: true, email: true },
        },
        doctor: {
          select: { id: true, name: true, email: true },
        },
      },
    });

    res.json({ consultations });
  } catch (error) {
    next(error);
  }
});
